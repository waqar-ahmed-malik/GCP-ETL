INSERT INTO OPERATIONAL.EXTERNAL_INS_TO_MBR_SPLITS_PAYMENTS
(PROC_DT,
BATCH_NUM,
BATCH_COUNT,
BATCH_AMT,
CHECK_ID,
LAST_NM,
FIRST_NM,
CHECK_NUM,
CHECK_AMT,
PYMT_RQST_NUM,
APP,
ACCOUNT_NUM,
MEMBERSHIP_NUM,
AMOUNT_APPLIED,
POSTMARK_DT,
SOURCE_FILE_NM,
SOURCE_FILE_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
SELECT
PARSE_DATE('%m/%d/%Y',TRIM(PROC_DT)),
SAFE_CAST(TRIM(BATCH_NUM) AS INT64),
SAFE_CAST(TRIM(BATCH_COUNT) AS INT64),
SAFE_CAST(TRIM(BATCH_AMT) AS FLOAT64),
TRIM(CHECK_ID),
TRIM(LAST_NM),
TRIM(FIRST_NM),
TRIM(CHECK_NUM),
SAFE_CAST(TRIM(CHECK_AMT) AS FLOAT64),
TRIM(PYMT_RQST_NUM),
TRIM(APP),
TRIM(ACCOUNT_NUM),
TRIM(MEMBERSHIP_NUM),
SAFE_CAST(TRIM(AMOUNT_APPLIED) AS FLOAT64),
PARSE_DATE('%m/%d/%Y',TRIM(POSTMARK_DT)),
'v_file_name',
PARSE_DATE("%Y-%m-%d",'v_file_date'),
SAFE_CAST('v_job_run_id' AS INT64),
'v_job_name',
CURRENT_DATETIME()
FROM LANDING.WORK_EXTERNAL_INS_TO_MBR_SPLITS_PAYMENTS