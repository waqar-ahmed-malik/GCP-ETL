INSERT INTO OPERATIONAL.EXTERNAL_PAYMODE_DETAIL_PAYMENTS
(DPA,
DISBURSER_ACCOUNT,
COLLECTOR_ACCOUNT,
PAYMENT_NUM,
PAYMENT_AMOUNT,
SETTLEMENT_DT,
PAYMENT_FILE_ID,
REMITTANCE_TYPE,
REMIT_NUM,
TRACE_NUM,
PAYMENT_DT,
CUSTOMER_NM,
CUSTOMER_ACCOUNT_NUM,
PAYMENT_AMT,
CURRENCY,
UNIQUE_KEY,
ORIGINATOR,
SOURCE_FILE_NM,
SOURCE_FILE_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
SELECT
TRIM(DPA),
TRIM(DISBURSER_ACCOUNT),
TRIM(COLLECTOR_ACCOUNT),
TRIM(PAYMENT_NUM),
SAFE_CAST(TRIM(PAYMENT_AMOUNT) AS FLOAT64),
PARSE_DATE('%m/%d/%Y',TRIM(SETTLEMENT_DT)),
TRIM(PAYMENT_FILE_ID),
TRIM(REMITTANCE_TYPE),
SAFE_CAST(TRIM(REMIT_NUM) AS INT64),
TRIM(TRACE_NUM),
PARSE_DATE('%m/%d/%Y',TRIM(PAYMENT_DT)),
TRIM(CUSTOMER_NM),
TRIM(CUSTOMER_ACCOUNT_NUM),
SAFE_CAST(TRIM(PAYMENT_AMT) AS FLOAT64),
TRIM(CURRENCY),
TRIM(UNIQUE_KEY),
TRIM(ORIGINATOR),
'v_file_name',
PARSE_DATE("%Y-%m-%d",'v_file_date'),
SAFE_CAST('v_job_run_id' AS INT64),
'v_job_name',
CURRENT_DATETIME()
FROM LANDING.WORK_EXTERNAL_PAYMODE_DETAIL_PAYMENTS