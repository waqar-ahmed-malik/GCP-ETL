INSERT INTO OPERATIONAL.EXTERNAL_INS_TO_MBR_PYMTRFRQST
(TRAN_SRC,
RECORD_DT,
LAST_NM,
TRF_TYPE,
FR_PROD,
FR_POLICY,
TO_PROD,
TO_POLICY,
AMOUNT,
PYMT_TYPE,
PYMT_CHANNEL,
REASON,
USER_ID,
AUTHORIZE,
NOTES,
PROCESS_ID,
STATUS,
COMPLETE_DT,
SOURCE_FILE_NM,
SOURCE_FILE_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
SELECT
TRIM(TRAN_SRC),
PARSE_DATE('%m/%d/%Y',TRIM(RECORD_DT)),
TRIM(LAST_NM),
SAFE_CAST(TRIM(TRF_TYPE) AS INT64),
TRIM(FR_PROD),
TRIM(FR_POLICY),
TRIM(TO_PROD),
TRIM(TO_POLICY),
SAFE_CAST(TRIM(AMOUNT) AS FLOAT64),
TRIM(PYMT_TYPE),
TRIM(PYMT_CHANNEL),
TRIM(REASON),
TRIM(USER_ID),
SAFE_CAST(TRIM(AUTHORIZE) AS INT64),
TRIM(NOTES),
TRIM(PROCESS_ID),
TRIM(STATUS),
PARSE_DATE('%m/%d/%Y',TRIM(COMPLETE_DT)),
'v_file_name',
PARSE_DATE("%Y-%m-%d",'v_file_date'),
SAFE_CAST('v_job_run_id' AS INT64),
'v_job_name',
CURRENT_DATETIME()
FROM LANDING.WORK_EXTERNAL_INS_TO_MBR_PYMTRFRQST