INSERT INTO OPERATIONAL.EXTERNAL_LOCKBOX_PAYMENT_DETAILS
(BATCH_NUM,
AR_SEQ,
TRAN_TRIGGER,
SITE_NUM,
CLIENT_ID,
BATCH_ID,
BALANCING_DT,
DOC_GRP_ID,
DOC_ID,
TRAN_NUM,
P1_SEQ_NUM,
T2_IDENTIFER,
APPLIED_AMT,
TOTAL_DUE,
PLUS_AMT,
PREM_AMT,
ACCOUNT_NUM,
TRAN_IND,
CC_LAST_4,
CC_TYPE,
CHECK_RT,
CHECKING_ACCOUNT,
CHECK_NUM,
DEPOSIT_METHOD,
OPC_PAYMENT_CHANNEL,
OPC_PAYMENT_METHOD,
OPC_DESC,
OPC_SMART_NUM,
SOURCE_FILE_NM,
SOURCE_FILE_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
SELECT SAFE_CAST(TRIM(BATCH_NUM) AS INT64),
SAFE_CAST(TRIM(AR_SEQ) AS INT64),
TRIM(TRAN_TRIGGER),
SAFE_CAST(TRIM(SITE_NUM) AS INT64),
SAFE_CAST(TRIM(CLIENT_ID) AS INT64),
SAFE_CAST(TRIM(BATCH_ID) AS INT64),
PARSE_DATE('%m/%d/%Y',TRIM(BALANCING_DT)),
SAFE_CAST(TRIM(DOC_GRP_ID) AS INT64),
SAFE_CAST(TRIM(DOC_ID) AS INT64),
SAFE_CAST(TRIM(TRAN_NUM) AS INT64),
SAFE_CAST(TRIM(P1_SEQ_NUM) AS INT64),
TRIM(T2_IDENTIFER),
SAFE_CAST(TRIM(APPLIED_AMT) AS FLOAT64),
SAFE_CAST(TRIM(TOTAL_DUE) AS FLOAT64),
SAFE_CAST(TRIM(PLUS_AMT) AS FLOAT64),
SAFE_CAST(TRIM(PREM_AMT) AS FLOAT64),
TRIM(ACCOUNT_NUM),
TRIM(TRAN_IND),
TRIM(CC_LAST_4),
TRIM(CC_TYPE),
TRIM(CHECK_RT),
TRIM(CHECKING_ACCOUNT),
TRIM(CHECK_NUM),
TRIM(DEPOSIT_METHOD),
TRIM(OPC_PAYMENT_CHANNEL),
TRIM(OPC_PAYMENT_METHOD),
TRIM(OPC_DESC),
TRIM(OPC_SMART_NUM),
'v_file_name',
PARSE_DATE("%Y-%m-%d",'v_file_date'),
SAFE_CAST('v_job_run_id' AS INT64),
'v_job_name',
CURRENT_DATETIME()
FROM LANDING.WORK_EXTERNAL_LOCKBOX_PAYMENT_DETAILS