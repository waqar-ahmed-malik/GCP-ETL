INSERT INTO OPERATIONAL.EXTERNAL_WD_CHECK_REFUND_PAYMENTS
(PAYMENT,
PAYMENT_CATEGORY,
REPORTING_TRANSACTION_COMPANY,
STATUS,
PAYEE_PAYOR,
TRANSACTION_DT,
PAYMENT_MEMO,
BANK_ACCOUNT,
PAYMENT_TYPE,
SETTLEMENT_RUN,
PAYMENT_GROUP,
REFERENCE,
PAYMENT_AMT,
CURRENCY,
RECONCILIATION_STATUS,
SOURCE_FILE_NM,
SOURCE_FILE_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
SELECT
TRIM(PAYMENT),
TRIM(PAYMENT_CATEGORY),
TRIM(REPORTING_TRANSACTION_COMPANY),
TRIM(STATUS),
TRIM(PAYEE_PAYOR),
PARSE_DATE('%m/%d/%Y',TRIM(TRANSACTION_DT)),
TRIM(PAYMENT_MEMO),
TRIM(BANK_ACCOUNT),
TRIM(PAYMENT_TYPE),
TRIM(SETTLEMENT_RUN),
TRIM(PAYMENT_GROUP),
TRIM(REFERENCE),
SAFE_CAST(TRIM(PAYMENT_AMT) AS FLOAT64),
TRIM(CURRENCY),
TRIM(RECONCILIATION_STATUS),
'v_file_name',
PARSE_DATE("%Y-%m-%d",'v_file_date'),
SAFE_CAST('v_job_run_id' AS INT64),
'v_job_name',
CURRENT_DATETIME()
FROM LANDING.WORK_EXTERNAL_WD_CHECK_REFUND_PAYMENTS