MERGE INTO LANDING.STAGE_MEMBERSHIP_BILL  TGT 
USING (SELECT ROW_NUMBER() OVER() as MEMBERSHIP_BILL_ID, BILL1.* from 
(SELECT SMB.ARIA_ACCOUNT_ID,
  CASE
    WHEN SMB.MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.MEMBER_NUM,15,2))
    ELSE SMB.MEMBER_NUM
  END AS MEMBER_NUM ,
  SMB.MEMBER_SINCE,
  SMB.MEMBER_EXPIRY_DT,
  SMB.PLAN,
  SMB.EVENT_TYPE,
  SUBSTR(SR.PREFERRED_NAME, 1, STRPOS(SR.PREFERRED_NAME,' ')-1) AS FIRST_NAME,
  ''                                                           AS MI,
  SUBSTR(SR.PREFERRED_NAME, STRPOS(SR.PREFERRED_NAME,' ')+1)    AS LAST_NAME,
  SMB.EMAIL,
  SMB.PHONE,
  SR.ADDRESS AS ADDRESS1,
  SR.CITY,
  SR.STATE,
  CAST(SR.ZIP AS STRING) AS ZIP,
  SMB.COUNTRY,
  SMB.CC_LAST_4_DIGITS,
  SMB.PAY_FAILED,
  SMB.PROMOCODE1,
  SMB.PROMO1_AMOUNT,
  SMB.PROMOCODE2,
  SMB.PROMO2_AMOUNT,
  SMB.PROMOCODE3,
  SMB.PROMO3_AMOUNT,
  SMB.SEC_MEMBER_DATA_PRESENT,
  SMB.ASSOC_MEMBER_DATA_PRESENT,
  SMB.NUM_ASSOC_MEMBERS,
  SMB.DONOR_MEMBER_DATA_PRESENT,
  SMB.GROUP_DATA_PRESENT,
  SMB.OTHER_INV_ITEM_DATA_PRESENT,
  SMB.NUM_OTHER_INV_ITEMS,
  CASE
    WHEN SMB.PRIMARY_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.PRIMARY_MEMBER_NUM,15,2))
    ELSE SMB.PRIMARY_MEMBER_NUM
  END AS PRIMARY_MEMBER_NUM,
  SMB.PRIMARY_MEMBER_SINCE,
  SMB.PRIMARY_MEMBER_EXPIRY_DT,
  SMB.PRIMARY_MEMBER_FIRST_NAME,
  SMB.PRIMARY_MEMBER_MI,
  SMB.PRIMARY_MEMBER_LAST_NAME,
  SMB.PRIMARY_MEMBER_FULL_NAME,
  SMB.PRIMARY_MEMBER_LINE_ITEM_DES,
  SMB.PRIMARY_MEMBER_LINE_ITEM_AMT,
  SMB.PRIMARY_MEMBER_ALTERNATE_AMT,
  CASE
    WHEN SMB.SECONDARY_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.SECONDARY_MEMBER_NUM,15,2))
    ELSE SMB.SECONDARY_MEMBER_NUM
  END AS SECONDARY_MEMBER_NUM,
  SMB.SECONDARY_MEMBER_SINCE,
  SMB.SECONDARY_MEMBER_EXPIRY_DT,
  SMB.SECONDARY_MEMBER_FIRST_NAME,
  SMB.SECONDARY_MEMBER_MI,
  SMB.SECONDARY_MEMBER_LAST_NAME,
  SMB.SECONDARY_MEMBER_FULL_NAME,
  SMB.SECONDARY_MEMBER_LINE_ITEM_DES,
  SMB.SECONDARY_MEMBER_LINE_ITEM_AMT,
  SMB.SECONDARY_MEMBER_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_1_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_1_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_1_MEMBER_NUM
  END AS ASSOC_1_MEMBER_NUM,
  SMB.ASSOC_1_MEMBER_SINCE,
  SMB.ASSOC_1_MEMBER_EXPIRY_DT,
  SMB.ASSOC_1_FIRST_NAME,
  SMB.ASSOC_1_MI,
  SMB.ASSOC_1_LAST_NAME,
  SMB.ASSOC_1_FULL_NAME,
  SMB.ASSOC_1_LINE_ITEM_DES,
  SMB.ASSOC_1_LINE_ITEM_AMT,
  SMB.ASSOC_1_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_2_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_2_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_2_MEMBER_NUM
  END AS ASSOC_2_MEMBER_NUM,
  SMB.ASSOC_2_MEMBER_SINCE,
  SMB.ASSOC_2_MEMBER_EXPIRY_DT,
  SMB.ASSOC_2_FIRST_NAME,
  SMB.ASSOC_2_MI,
  SMB.ASSOC_2_LAST_NAME,
  SMB.ASSOC_2_FULL_NAME,
  SMB.ASSOC_2_LINE_ITEM_DES,
  SMB.ASSOC_2_LINE_ITEM_AMT,
  SMB.ASSOC_2_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_3_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_3_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_3_MEMBER_NUM
  END AS ASSOC_3_MEMBER_NUM,
  SMB.ASSOC_3_MEMBER_SINCE,
  SMB.ASSOC_3_MEMBER_EXPIRY_DT,
  SMB.ASSOC_3_FIRST_NAME,
  SMB.ASSOC_3_MI,
  SMB.ASSOC_3_LAST_NAME,
  SMB.ASSOC_3_FULL_NAME,
  SMB.ASSOC_3_LINE_ITEM_DES,
  SMB.ASSOC_3_LINE_ITEM_AMT,
  SMB.ASSOC_3_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_4_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_4_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_4_MEMBER_NUM
  END AS ASSOC_4_MEMBER_NUM,
  SMB.ASSOC_4_MEMBER_SINCE,
  SMB.ASSOC_4_MEMBER_EXPIRY_DT,
  SMB.ASSOC_4_FIRST_NAME,
  SMB.ASSOC_4_MI,
  SMB.ASSOC_4_LAST_NAME,
  SMB.ASSOC_4_FULL_NAME,
  SMB.ASSOC_4_LINE_ITEM_DES,
  SMB.ASSOC_4_LINE_ITEM_AMT,
  SMB.ASSOC_4_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_5_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_5_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_5_MEMBER_NUM
  END AS ASSOC_5_MEMBER_NUM,
  SMB.ASSOC_5_MEMBER_SINCE,
  SMB.ASSOC_5_MEMBER_EXPIRY_DT,
  SMB.ASSOC_5_FIRST_NAME,
  SMB.ASSOC_5_MI,
  SMB.ASSOC_5_LAST_NAME,
  SMB.ASSOC_5_FULL_NAME,
  SMB.ASSOC_5_LINE_ITEM_DES,
  SMB.ASSOC_5_LINE_ITEM_AMT,
  SMB.ASSOC_5_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_6_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_6_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_6_MEMBER_NUM
  END AS ASSOC_6_MEMBER_NUM,
  SMB.ASSOC_6_MEMBER_SINCE,
  SMB.ASSOC_6_MEMBER_EXPIRY_DT,
  SMB.ASSOC_6_FIRST_NAME,
  SMB.ASSOC_6_MI,
  SMB.ASSOC_6_LAST_NAME,
  SMB.ASSOC_6_FULL_NAME,
  SMB.ASSOC_6_LINE_ITEM_DES,
  SMB.ASSOC_6_LINE_ITEM_AMT,
  SMB.ASSOC_6_ALTERNATE_AMT,
  CASE
    WHEN SMB.ASSOC_7_MEMBER_NUM IS NOT NULL
    THEN CONCAT(CAST(SR.MEMBERSHIP_NUM AS STRING),'',SUBSTR(SMB.ASSOC_7_MEMBER_NUM,15,2))
    ELSE SMB.ASSOC_7_MEMBER_NUM
  END AS ASSOC_7_MEMBER_NUM,
  SMB.ASSOC_7_MEMBER_SINCE,
  SMB.ASSOC_7_MEMBER_EXPIRY_DT,
  SMB.ASSOC_7_FIRST_NAME,
  SMB.ASSOC_7_MI,
  SMB.ASSOC_7_LAST_NAME,
  SMB.ASSOC_7_FULL_NAME,
  SMB.ASSOC_7_LINE_ITEM_DES,
  SMB.ASSOC_7_LINE_ITEM_AMT,
  SMB.ASSOC_7_ALTERNATE_AMT,
  SMB.TOTAL_ALTERNATE_AMT,
  SMB.DONOR_FIRST_NAME,
  SMB.DONOR_MI,
  SMB.DONOR_LAST_NAME,
  SMB.MEM_GROUP,
  SMB.ADDITIONAL_DUES_AND_FEES,
  SMB.TOTAL_AMT_DUE,
  SMB.TOTAL_AMT_PAID,
  SMB.PAYMENT_DUE_DATE,
  SMB.PLUS_UPGRADE_AMT,
  SMB.PREMIER_UPGRADE_AMT,
  SMB.ASSOCIATE_CHARGE_RATE,
  SMB.OUTPUT_FILE_NAME,
  CONCAT('SED_','',CAST(SR.SEED_ID AS STRING)) AS STATEMENT_NO,
  SMB.FILE_GENERATED,
  SMB.JOB_RUN_ID,
  SMB.SOURCE_SYSTEM_CD,
  SMB.CREATE_DTTIME,
  SMB.UPDATE_DTTIME,
  SMB.BILL_KEY,
  SMB.BILL_PAY_METHOD_CD,
  SMB.CURRENTLY_HAS_AUTO,
  SMB.CURRENTLY_HAS_HOME,
  SMB.ISSUING_STATE,
  SMB.PREFERRED_LANGUAGE,
  SMB.LINE_ITEM,
  SMB.DESCRIPTION,
  SMB.AMOUNT
FROM
  (SELECT SM.*,
    ROW_NUMBER() OVER(PARTITION BY SM.EVENT_TYPE ORDER BY SM.EVENT_TYPE) ROW_NUM
  FROM LANDING.STAGE_MEMBERSHIP_BILL SM
  WHERE UPPER(SM.EVENT_TYPE)  = 'BILL1'
 AND CAST(SM.CREATE_DTTIME AS DATE)  = CAST(CURRENT_DATE() as DATE)
  AND EXTRACT(DAY FROM CURRENT_DATE())=1
  ) SMB
INNER JOIN REFERENCE.BILLS_SEED_RECIPIENT SR
ON UPPER(SMB.EVENT_TYPE)   = UPPER(SR.EVENT_TYPE)
AND SR.DATE_DOCUMENT_SENT IS NULL
WHERE SMB.ROW_NUM          =1
) BILL1) SRC
ON (TGT.STATEMENT_NO=SRC.STATEMENT_NO 
AND TGT.BILL_KEY=SRC.BILL_KEY 
AND TGT.SOURCE_SYSTEM_CD='CONNECT SUITE'
AND CAST(TGT.CREATE_DTTIME AS DATE)>=DATE_SUB(current_date(), INTERVAL 7 DAY) 
AND CAST(TGT.CREATE_DTTIME AS DATE)<=current_date()
)
WHEN NOT MATCHED THEN
  INSERT (MEMBERSHIP_BILL_ID,
  ARIA_ACCOUNT_ID,
MEMBER_NUM,
MEMBER_SINCE,
MEMBER_EXPIRY_DT,
PLAN,
EVENT_TYPE,
FIRST_NAME,
MI,
LAST_NAME,
EMAIL,
PHONE,
ADDRESS1,
CITY,
STATE,
ZIP,
COUNTRY,
CC_LAST_4_DIGITS,
PAY_FAILED,
PROMOCODE1,
PROMO1_AMOUNT,
PROMOCODE2,
PROMO2_AMOUNT,
PROMOCODE3,
PROMO3_AMOUNT,
SEC_MEMBER_DATA_PRESENT,
ASSOC_MEMBER_DATA_PRESENT,
NUM_ASSOC_MEMBERS,
DONOR_MEMBER_DATA_PRESENT,
GROUP_DATA_PRESENT,
OTHER_INV_ITEM_DATA_PRESENT,
NUM_OTHER_INV_ITEMS,
PRIMARY_MEMBER_NUM,
PRIMARY_MEMBER_SINCE,
PRIMARY_MEMBER_EXPIRY_DT,
PRIMARY_MEMBER_FIRST_NAME,
PRIMARY_MEMBER_MI,
PRIMARY_MEMBER_LAST_NAME,
PRIMARY_MEMBER_FULL_NAME,
PRIMARY_MEMBER_LINE_ITEM_DES,
PRIMARY_MEMBER_LINE_ITEM_AMT,
PRIMARY_MEMBER_ALTERNATE_AMT,
SECONDARY_MEMBER_NUM,
SECONDARY_MEMBER_SINCE,
SECONDARY_MEMBER_EXPIRY_DT,
SECONDARY_MEMBER_FIRST_NAME,
SECONDARY_MEMBER_MI,
SECONDARY_MEMBER_LAST_NAME,
SECONDARY_MEMBER_FULL_NAME,
SECONDARY_MEMBER_LINE_ITEM_DES,
SECONDARY_MEMBER_LINE_ITEM_AMT,
SECONDARY_MEMBER_ALTERNATE_AMT,
ASSOC_1_MEMBER_NUM,
ASSOC_1_MEMBER_SINCE,
ASSOC_1_MEMBER_EXPIRY_DT,
ASSOC_1_FIRST_NAME,
ASSOC_1_MI,
ASSOC_1_LAST_NAME,
ASSOC_1_FULL_NAME,
ASSOC_1_LINE_ITEM_DES,
ASSOC_1_LINE_ITEM_AMT,
ASSOC_1_ALTERNATE_AMT,
ASSOC_2_MEMBER_NUM,
ASSOC_2_MEMBER_SINCE,
ASSOC_2_MEMBER_EXPIRY_DT,
ASSOC_2_FIRST_NAME,
ASSOC_2_MI,
ASSOC_2_LAST_NAME,
ASSOC_2_FULL_NAME,
ASSOC_2_LINE_ITEM_DES,
ASSOC_2_LINE_ITEM_AMT,
ASSOC_2_ALTERNATE_AMT,
ASSOC_3_MEMBER_NUM,
ASSOC_3_MEMBER_SINCE,
ASSOC_3_MEMBER_EXPIRY_DT,
ASSOC_3_FIRST_NAME,
ASSOC_3_MI,
ASSOC_3_LAST_NAME,
ASSOC_3_FULL_NAME,
ASSOC_3_LINE_ITEM_DES,
ASSOC_3_LINE_ITEM_AMT,
ASSOC_3_ALTERNATE_AMT,
ASSOC_4_MEMBER_NUM,
ASSOC_4_MEMBER_SINCE,
ASSOC_4_MEMBER_EXPIRY_DT,
ASSOC_4_FIRST_NAME,
ASSOC_4_MI,
ASSOC_4_LAST_NAME,
ASSOC_4_FULL_NAME,
ASSOC_4_LINE_ITEM_DES,
ASSOC_4_LINE_ITEM_AMT,
ASSOC_4_ALTERNATE_AMT,
ASSOC_5_MEMBER_NUM,
ASSOC_5_MEMBER_SINCE,
ASSOC_5_MEMBER_EXPIRY_DT,
ASSOC_5_FIRST_NAME,
ASSOC_5_MI,
ASSOC_5_LAST_NAME,
ASSOC_5_FULL_NAME,
ASSOC_5_LINE_ITEM_DES,
ASSOC_5_LINE_ITEM_AMT,
ASSOC_5_ALTERNATE_AMT,
ASSOC_6_MEMBER_NUM,
ASSOC_6_MEMBER_SINCE,
ASSOC_6_MEMBER_EXPIRY_DT,
ASSOC_6_FIRST_NAME,
ASSOC_6_MI,
ASSOC_6_LAST_NAME,
ASSOC_6_FULL_NAME,
ASSOC_6_LINE_ITEM_DES,
ASSOC_6_LINE_ITEM_AMT,
ASSOC_6_ALTERNATE_AMT,
ASSOC_7_MEMBER_NUM,
ASSOC_7_MEMBER_SINCE,
ASSOC_7_MEMBER_EXPIRY_DT,
ASSOC_7_FIRST_NAME,
ASSOC_7_MI,
ASSOC_7_LAST_NAME,
ASSOC_7_FULL_NAME,
ASSOC_7_LINE_ITEM_DES,
ASSOC_7_LINE_ITEM_AMT,
ASSOC_7_ALTERNATE_AMT,
TOTAL_ALTERNATE_AMT,
DONOR_FIRST_NAME,
DONOR_MI,
DONOR_LAST_NAME,
MEM_GROUP,
ADDITIONAL_DUES_AND_FEES,
TOTAL_AMT_DUE,
TOTAL_AMT_PAID,
PAYMENT_DUE_DATE,
PLUS_UPGRADE_AMT,
PREMIER_UPGRADE_AMT,
ASSOCIATE_CHARGE_RATE,
OUTPUT_FILE_NAME,
STATEMENT_NO,
FILE_GENERATED,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME,
UPDATE_DTTIME,
BILL_KEY,
BILL_PAY_METHOD_CD,
CURRENTLY_HAS_AUTO,
CURRENTLY_HAS_HOME,
ISSUING_STATE,
PREFERRED_LANGUAGE,
LINE_ITEM,
DESCRIPTION,
AMOUNT,
EXCEPTION_FLAG,
EXCEPTION_REASON)
VALUES(
SRC.MEMBERSHIP_BILL_ID + (SELECT IFNULL(MAX(MEMBERSHIP_BILL_ID),0) FROM LANDING.STAGE_MEMBERSHIP_BILL) ,
null,
SRC.MEMBER_NUM,
SRC.MEMBER_SINCE,
SRC.MEMBER_EXPIRY_DT,
SRC.PLAN,
SRC.EVENT_TYPE,
SRC.FIRST_NAME,
SRC.MI,
SRC.LAST_NAME,
SRC.EMAIL,
SRC.PHONE,
SRC.ADDRESS1,
SRC.CITY,
SRC.STATE,
SRC.ZIP,
SRC.COUNTRY,
SRC.CC_LAST_4_DIGITS,
SRC.PAY_FAILED,
SRC.PROMOCODE1,
SRC.PROMO1_AMOUNT,
SRC.PROMOCODE2,
SRC.PROMO2_AMOUNT,
SRC.PROMOCODE3,
SRC.PROMO3_AMOUNT,
SRC.SEC_MEMBER_DATA_PRESENT,
SRC.ASSOC_MEMBER_DATA_PRESENT,
SRC.NUM_ASSOC_MEMBERS,
SRC.DONOR_MEMBER_DATA_PRESENT,
SRC.GROUP_DATA_PRESENT,
SRC.OTHER_INV_ITEM_DATA_PRESENT,
CAST(SRC.NUM_OTHER_INV_ITEMS AS INT64),
SRC.PRIMARY_MEMBER_NUM,
SRC.PRIMARY_MEMBER_SINCE,
SRC.PRIMARY_MEMBER_EXPIRY_DT,
SRC.PRIMARY_MEMBER_FIRST_NAME,
SRC.PRIMARY_MEMBER_MI,
SRC.PRIMARY_MEMBER_LAST_NAME,
SRC.PRIMARY_MEMBER_FULL_NAME,
SRC.PRIMARY_MEMBER_LINE_ITEM_DES,
SRC.PRIMARY_MEMBER_LINE_ITEM_AMT,
SRC.PRIMARY_MEMBER_ALTERNATE_AMT,
SRC.SECONDARY_MEMBER_NUM,
SRC.SECONDARY_MEMBER_SINCE,
SRC.SECONDARY_MEMBER_EXPIRY_DT,
SRC.SECONDARY_MEMBER_FIRST_NAME,
SRC.SECONDARY_MEMBER_MI,
SRC.SECONDARY_MEMBER_LAST_NAME,
SRC.SECONDARY_MEMBER_FULL_NAME,
SRC.SECONDARY_MEMBER_LINE_ITEM_DES,
SRC.SECONDARY_MEMBER_LINE_ITEM_AMT,
SRC.SECONDARY_MEMBER_ALTERNATE_AMT,
SRC.ASSOC_1_MEMBER_NUM,
SRC.ASSOC_1_MEMBER_SINCE,
SRC.ASSOC_1_MEMBER_EXPIRY_DT,
SRC.ASSOC_1_FIRST_NAME,
SRC.ASSOC_1_MI,
SRC.ASSOC_1_LAST_NAME,
SRC.ASSOC_1_FULL_NAME,
SRC.ASSOC_1_LINE_ITEM_DES,
SRC.ASSOC_1_LINE_ITEM_AMT,
SRC.ASSOC_1_ALTERNATE_AMT,
SRC.ASSOC_2_MEMBER_NUM,
SRC.ASSOC_2_MEMBER_SINCE,
SRC.ASSOC_2_MEMBER_EXPIRY_DT,
SRC.ASSOC_2_FIRST_NAME,
SRC.ASSOC_2_MI,
SRC.ASSOC_2_LAST_NAME,
SRC.ASSOC_2_FULL_NAME,
SRC.ASSOC_2_LINE_ITEM_DES,
SRC.ASSOC_2_LINE_ITEM_AMT,
SRC.ASSOC_2_ALTERNATE_AMT,
SRC.ASSOC_3_MEMBER_NUM,
SRC.ASSOC_3_MEMBER_SINCE,
SRC.ASSOC_3_MEMBER_EXPIRY_DT,
SRC.ASSOC_3_FIRST_NAME,
SRC.ASSOC_3_MI,
SRC.ASSOC_3_LAST_NAME,
SRC.ASSOC_3_FULL_NAME,
SRC.ASSOC_3_LINE_ITEM_DES,
SRC.ASSOC_3_LINE_ITEM_AMT,
SRC.ASSOC_3_ALTERNATE_AMT,
SRC.ASSOC_4_MEMBER_NUM,
SRC.ASSOC_4_MEMBER_SINCE,
SRC.ASSOC_4_MEMBER_EXPIRY_DT,
SRC.ASSOC_4_FIRST_NAME,
SRC.ASSOC_4_MI,
SRC.ASSOC_4_LAST_NAME,
SRC.ASSOC_4_FULL_NAME,
SRC.ASSOC_4_LINE_ITEM_DES,
SRC.ASSOC_4_LINE_ITEM_AMT,
SRC.ASSOC_4_ALTERNATE_AMT,
SRC.ASSOC_5_MEMBER_NUM,
SRC.ASSOC_5_MEMBER_SINCE,
SRC.ASSOC_5_MEMBER_EXPIRY_DT,
SRC.ASSOC_5_FIRST_NAME,
SRC.ASSOC_5_MI,
SRC.ASSOC_5_LAST_NAME,
SRC.ASSOC_5_FULL_NAME,
SRC.ASSOC_5_LINE_ITEM_DES,
SRC.ASSOC_5_LINE_ITEM_AMT,
SRC.ASSOC_5_ALTERNATE_AMT,
SRC.ASSOC_6_MEMBER_NUM,
SRC.ASSOC_6_MEMBER_SINCE,
SRC.ASSOC_6_MEMBER_EXPIRY_DT,
SRC.ASSOC_6_FIRST_NAME,
SRC.ASSOC_6_MI,
SRC.ASSOC_6_LAST_NAME,
SRC.ASSOC_6_FULL_NAME,
SRC.ASSOC_6_LINE_ITEM_DES,
SRC.ASSOC_6_LINE_ITEM_AMT,
SRC.ASSOC_6_ALTERNATE_AMT,
SRC.ASSOC_7_MEMBER_NUM,
SRC.ASSOC_7_MEMBER_SINCE,
SRC.ASSOC_7_MEMBER_EXPIRY_DT,
SRC.ASSOC_7_FIRST_NAME,
SRC.ASSOC_7_MI,
SRC.ASSOC_7_LAST_NAME,
SRC.ASSOC_7_FULL_NAME,
SRC.ASSOC_7_LINE_ITEM_DES,
SRC.ASSOC_7_LINE_ITEM_AMT,
SRC.ASSOC_7_ALTERNATE_AMT,
SRC.TOTAL_ALTERNATE_AMT,
SRC.DONOR_FIRST_NAME,
SRC.DONOR_MI,
SRC.DONOR_LAST_NAME,
SRC.MEM_GROUP,
SRC.ADDITIONAL_DUES_AND_FEES,
SRC.TOTAL_AMT_DUE,
SRC.TOTAL_AMT_PAID,
SRC.PAYMENT_DUE_DATE,
SRC.PLUS_UPGRADE_AMT,
SRC.PREMIER_UPGRADE_AMT,
SRC.ASSOCIATE_CHARGE_RATE,
'ST{{ execution_date.strftime("%Y%m%d%H%M%S") }}0011BLL.xml',
SRC.STATEMENT_NO,
'N',
CAST(FORMAT_DATE("%Y%m%d",current_date()) AS INT64),
'CONNECT SUITE',
CURRENT_DATETIME(),
CURRENT_DATETIME(),
SRC.BILL_KEY,
SRC.BILL_PAY_METHOD_CD,
SRC.CURRENTLY_HAS_AUTO,
SRC.CURRENTLY_HAS_HOME,
SRC.ISSUING_STATE,
SRC.PREFERRED_LANGUAGE,
CAST(SRC.LINE_ITEM AS STRING),
SRC.DESCRIPTION,
SRC.AMOUNT,
'N',
NULL
)
