MERGE INTO 	OPERATIONAL.STAGE_POS_INSURANCE_PAYMENTS TGT
USING 
 (SELECT ROW_NUMBER() OVER() as POS_INSURANCE_PAYMENTS_ID,
SRC.POS_TRANSACTION_ID AS EXTERNAL_REFERENCE_NUMBER,
CAST(SRC.POS_TRANSACTION_ID AS STRING) AS POS_TRANSACTION_ID,
SRC.RECORD_IDENTIFIER AS RECORD_IDENTIFIER,
CAST(SRC.BRANCH_NUMBER AS INT64) AS BRANCH_NUMBER,
CAST(NULL AS INT64) AS BRANCH_HUB_NUMBER,
CAST(BRANCH_DEVICE_NUMBER AS INT64) AS BRANCH_DEVICE_NUMBER,
CAST(SRC.CLUB_CODE AS INT64) AS CLUB_CODE,
SRC.USER_ID,
CAST(SRC.TRANSACTION_DATE AS INT64) AS TRANSACTION_DATE,
CAST(SRC.TRANSACTION_TIME AS INT64) AS TRANSACTION_TIME,
CAST(SRC.TRANSACTION_POSTMARK_DATE AS STRING) AS TRANSACTION_POSTMARK_DATE,
SRC.TRANSACTION_TOTAL_AMOUNT,
SRC.CASH_TRANSACTION_FOP,
SRC.CASH_FOP_AMOUNT,
SRC.CASH_PAYMENT_CARD_TYPE,
SRC.CASH_PAYMENT_CARD_LAST4,
SRC.CASH_PYMT_CARD_EXPIRATION_MON,
SRC.CASH_PYMT_CARD_EXPIRATION_YR,
SRC.CASH_ORDER_NUMBER,
SRC.CASH_ORDER_SEQUENCE_NUMBER,
SRC.CASH_CHECK_NUMBER,
SRC.CHCK_TRANSACTION_FOP,
SRC.CHCK_FOP_AMOUNT,
SRC.CHCK_PAYMENT_CARD_TYPE,
SRC.CHCK_PAYMENT_CARD_LAST4,
SRC.CHCK_PYMT_CARD_EXPIRATION_MON,
SRC.CHCK_PYMT_CARD_EXPIRATION_YR,
SRC.CHCK_ORDER_NUMBER,
SRC.CHCK_ORDER_SEQUENCE_NUMBER,
SRC.CHCK_CHECK_NUMBER,
SRC.VISA_TRANSACTION_FOP,
CAST(SRC.VISA_FOP_AMOUNT AS STRING) AS VISA_FOP_AMOUNT,
SRC.VISA_PAYMENT_CARD_TYPE,
SRC.VISA_PAYMENT_CARD_LAST4,
SRC.VISA_PYMT_CARD_EXPIRATION_MON,
SRC.VISA_PYMT_CARD_EXPIRATION_YR,
SRC.VISA_ORDER_NUMBER,
SRC.VISA_ORDER_SEQUENCE_NUMBER,
SRC.VISA_CHECK_NUMBER,
SRC.MASTER_TRANSACTION_FOP,
CAST(SRC.MASTER_FOP_AMOUNT AS STRING) AS MASTER_FOP_AMOUNT,
SRC.MASTER_PAYMENT_CARD_TYPE,
SRC.MASTER_PAYMENT_CARD_LAST4,
SRC.MSTR_PYMT_CARD_EXPIRATION_MON,
SRC.MSTR_PYMT_CARD_EXPIRATION_YR,
SRC.MASTER_ORDER_NUMBER,
SRC.MASTER_ORDER_SEQUENCE_NUMBER,
SRC.MASTER_CHECK_NUMBER,
SRC.DEBIT_TRANSACTION_FOP,
CAST(SRC.DEBIT_FOP_AMOUNT AS STRING) AS DEBIT_FOP_AMOUNT,
SRC.DEBIT_PAYMENT_CARD_TYPE,
SRC.DEBIT_PAYMENT_CARD_LAST4,
SRC.DEBIT_PYMT_CARD_EXPIRATION_MON,
SRC.DEBIT_PYMT_CARD_EXPIRATION_YR,
SRC.DEBIT_ORDER_NUMBER,
SRC.DEBIT_ORDER_SEQUENCE_NUMBER,
SRC.DEBIT_CHECK_NUMBER,
SRC.LI1_AGMT_SOURCE_SYSTEM,
SRC.LI1_COMPANY_ID,
SRC.LI1_PRODUCT_TYPE,
SRC.LI1_POLICY_PREFIX,
SRC.LI1_AGMT_NUMBER,
SRC.LI1_AGMT_STATE_CODE,
SRC.LI1_LINE_ITEM_AMOUNT,
SRC.LI2_AGMT_SOURCE_SYSTEM,
SRC.LI2_COMPANY_ID,
SRC.LI2_PRODUCT_TYPE,
SRC.LI2_POLICY_PREFIX,
SRC.LI2_AGMT_NUMBER,
SRC.LI2_AGMT_STATE_CODE,
SRC.LI2_LINE_ITEM_AMOUNT,
SRC.LI3_AGMT_SOURCE_SYSTEM,
SRC.LI3_COMPANY_ID,
SRC.LI3_PRODUCT_TYPE,
SRC.LI3_POLICY_PREFIX,
SRC.LI3_AGMT_NUMBER,
SRC.LI3_AGMT_STATE_CODE,
SRC.LI3_LINE_ITEM_AMOUNT,
SRC.LI4_AGMT_SOURCE_SYSTEM,
SRC.LI4_COMPANY_ID,
SRC.LI4_PRODUCT_TYPE,
SRC.LI4_POLICY_PREFIX,
SRC.LI4_AGMT_NUMBER,
SRC.LI4_AGMT_STATE_CODE,
CAST(SRC.LI4_LINE_ITEM_AMOUNT AS STRING) AS LI4_LINE_ITEM_AMOUNT,
SRC.LI5_AGMT_SOURCE_SYSTEM,
SRC.LI5_COMPANY_ID,
SRC.LI5_PRODUCT_TYPE,
SRC.LI5_POLICY_PREFIX,
SRC.LI5_AGMT_NUMBER,
SRC.LI5_AGMT_STATE_CODE,
CAST(SRC.LI5_LINE_ITEM_AMOUNT AS STRING) AS LI5_LINE_ITEM_AMOUNT,
SRC.LI6_AGMT_SOURCE_SYSTEM,
SRC.LI6_COMPANY_ID,
SRC.LI6_PRODUCT_TYPE,
SRC.LI6_POLICY_PREFIX,
SRC.LI6_AGMT_NUMBER,
SRC.LI6_AGMT_STATE_CODE,
CAST(SRC.LI6_LINE_ITEM_AMOUNT AS STRING) AS LI6_LINE_ITEM_AMOUNT,
SRC.LI7_AGMT_SOURCE_SYSTEM,
SRC.LI7_COMPANY_ID,
SRC.LI7_PRODUCT_TYPE,
SRC.LI7_POLICY_PREFIX,
SRC.LI7_AGMT_NUMBER,
SRC.LI7_AGMT_STATE_CODE,
CAST(SRC.LI7_LINE_ITEM_AMOUNT AS STRING) AS LI7_LINE_ITEM_AMOUNT,
SRC.LI8_AGMT_SOURCE_SYSTEM,
SRC.LI8_COMPANY_ID,
SRC.LI8_PRODUCT_TYPE,
SRC.LI8_POLICY_PREFIX,
SRC.LI8_AGMT_NUMBER,
SRC.LI8_AGMT_STATE_CODE,
CAST(SRC.LI8_LINE_ITEM_AMOUNT AS STRING) AS LI8_LINE_ITEM_AMOUNT,
SRC.LI9_AGMT_SOURCE_SYSTEM,
SRC.LI9_COMPANY_ID,
SRC.LI9_PRODUCT_TYPE,
SRC.LI9_POLICY_PREFIX,
SRC.LI9_AGMT_NUMBER,
SRC.LI9_AGMT_STATE_CODE,
CAST(SRC.LI9_LINE_ITEM_AMOUNT AS STRING) AS LI9_LINE_ITEM_AMOUNT,
SRC.LI10_AGMT_SOURCE_SYSTEM,
SRC.LI10_COMPANY_ID,
SRC.LI10_PRODUCT_TYPE,
SRC.LI10_POLICY_PREFIX,
SRC.LI10_AGMT_NUMBER,
SRC.LI10_AGMT_STATE_CODE,
CAST(SRC.LI10_LINE_ITEM_AMOUNT AS STRING) AS LI10_LINE_ITEM_AMOUNT,
SRC.ADJUSTMENT_CHECK_AMT,
SRC.POLICYADJUSTMENT_CASH_AMT,
SRC.POLICYADJUSTMENT_CRDT_AMT,
1234 AS JOB_RUN_ID,
'CONNECT SUITE' AS SOURCE_SYSTEM_CD
FROM LANDING.WORK_STAGE_POS_INSURANCE_PAYMENTS SRC
WHERE NOT EXISTS (SELECT 1 FROM OPERATIONAL.STAGE_POS_INSURANCE_PAYMENTS INS WHERE INS.POS_TRANSACTION_ID=CAST(SRC.POS_TRANSACTION_ID AS STRING))
) SRC
ON TGT.POS_TRANSACTION_ID=SRC.POS_TRANSACTION_ID
WHEN MATCHED  THEN  UPDATE   SET
TGT.EXTERNAL_REFERENCE_NUMBER=SRC.EXTERNAL_REFERENCE_NUMBER,
TGT.POS_TRANSACTION_ID=SRC.POS_TRANSACTION_ID,
TGT.RECORD_IDENTIFIER=SRC.RECORD_IDENTIFIER,
TGT.BRANCH_NUMBER=SRC.BRANCH_NUMBER,
TGT.BRANCH_HUB_NUMBER=SRC.BRANCH_HUB_NUMBER,
TGT.BRANCH_DEVICE_NUMBER=SRC.BRANCH_DEVICE_NUMBER,
TGT.CLUB_CODE=SRC.CLUB_CODE,
TGT.USER_ID=SRC.USER_ID,
TGT.TRANSACTION_DATE=SRC.TRANSACTION_DATE,
TGT.TRANSACTION_TIME=SRC.TRANSACTION_TIME,
TGT.TRANSACTION_POSTMARK_DATE=SRC.TRANSACTION_POSTMARK_DATE,
TGT.TRANSACTION_TOTAL_AMOUNT=SRC.TRANSACTION_TOTAL_AMOUNT,
TGT.CASH_TRANSACTION_FOP=SRC.CASH_TRANSACTION_FOP,
TGT.CASH_FOP_AMOUNT=SRC.CASH_FOP_AMOUNT,
TGT.CASH_PAYMENT_CARD_TYPE=SRC.CASH_PAYMENT_CARD_TYPE,
TGT.CASH_PAYMENT_CARD_LAST4=SRC.CASH_PAYMENT_CARD_LAST4,
TGT.CASH_PYMT_CARD_EXPIRATION_MON=SRC.CASH_PYMT_CARD_EXPIRATION_MON,
TGT.CASH_PYMT_CARD_EXPIRATION_YR=SRC.CASH_PYMT_CARD_EXPIRATION_YR,
TGT.CASH_ORDER_NUMBER=SRC.CASH_ORDER_NUMBER,
TGT.CASH_ORDER_SEQUENCE_NUMBER=SRC.CASH_ORDER_SEQUENCE_NUMBER,
TGT.CASH_CHECK_NUMBER=SRC.CASH_CHECK_NUMBER,
TGT.CHCK_TRANSACTION_FOP=SRC.CHCK_TRANSACTION_FOP,
TGT.CHCK_FOP_AMOUNT=SRC.CHCK_FOP_AMOUNT,
TGT.CHCK_PAYMENT_CARD_TYPE=SRC.CHCK_PAYMENT_CARD_TYPE,
TGT.CHCK_PAYMENT_CARD_LAST4=SRC.CHCK_PAYMENT_CARD_LAST4,
TGT.CHCK_PYMT_CARD_EXPIRATION_MON=SRC.CHCK_PYMT_CARD_EXPIRATION_MON,
TGT.CHCK_PYMT_CARD_EXPIRATION_YR=SRC.CHCK_PYMT_CARD_EXPIRATION_YR,
TGT.CHCK_ORDER_NUMBER=SRC.CHCK_ORDER_NUMBER,
TGT.CHCK_ORDER_SEQUENCE_NUMBER=SRC.CHCK_ORDER_SEQUENCE_NUMBER,
TGT.CHCK_CHECK_NUMBER=SRC.CHCK_CHECK_NUMBER,
TGT.VISA_TRANSACTION_FOP=SRC.VISA_TRANSACTION_FOP,
TGT.VISA_FOP_AMOUNT=SRC.VISA_FOP_AMOUNT,
TGT.VISA_PAYMENT_CARD_TYPE=SRC.VISA_PAYMENT_CARD_TYPE,
TGT.VISA_PAYMENT_CARD_LAST4=SRC.VISA_PAYMENT_CARD_LAST4,
TGT.VISA_PYMT_CARD_EXPIRATION_MON=SRC.VISA_PYMT_CARD_EXPIRATION_MON,
TGT.VISA_PYMT_CARD_EXPIRATION_YR=SRC.VISA_PYMT_CARD_EXPIRATION_YR,
TGT.VISA_ORDER_NUMBER=SRC.VISA_ORDER_NUMBER,
TGT.VISA_ORDER_SEQUENCE_NUMBER=SRC.VISA_ORDER_SEQUENCE_NUMBER,
TGT.VISA_CHECK_NUMBER=SRC.VISA_CHECK_NUMBER,
TGT.MASTER_TRANSACTION_FOP=SRC.MASTER_TRANSACTION_FOP,
TGT.MASTER_FOP_AMOUNT=SRC.MASTER_FOP_AMOUNT,
TGT.MASTER_PAYMENT_CARD_TYPE=SRC.MASTER_PAYMENT_CARD_TYPE,
TGT.MASTER_PAYMENT_CARD_LAST4=SRC.MASTER_PAYMENT_CARD_LAST4,
TGT.MSTR_PYMT_CARD_EXPIRATION_MON=SRC.MSTR_PYMT_CARD_EXPIRATION_MON,
TGT.MSTR_PYMT_CARD_EXPIRATION_YR=SRC.MSTR_PYMT_CARD_EXPIRATION_YR,
TGT.MASTER_ORDER_NUMBER=SRC.MASTER_ORDER_NUMBER,
TGT.MASTER_ORDER_SEQUENCE_NUMBER=SRC.MASTER_ORDER_SEQUENCE_NUMBER,
TGT.MASTER_CHECK_NUMBER=SRC.MASTER_CHECK_NUMBER,
TGT.DEBIT_TRANSACTION_FOP=SRC.DEBIT_TRANSACTION_FOP,
TGT.DEBIT_FOP_AMOUNT=SRC.DEBIT_FOP_AMOUNT,
TGT.DEBIT_PAYMENT_CARD_TYPE=SRC.DEBIT_PAYMENT_CARD_TYPE,
TGT.DEBIT_PAYMENT_CARD_LAST4=SRC.DEBIT_PAYMENT_CARD_LAST4,
TGT.DEBIT_PYMT_CARD_EXPIRATION_MON=SRC.DEBIT_PYMT_CARD_EXPIRATION_MON,
TGT.DEBIT_PYMT_CARD_EXPIRATION_YR=SRC.DEBIT_PYMT_CARD_EXPIRATION_YR,
TGT.DEBIT_ORDER_NUMBER=SRC.DEBIT_ORDER_NUMBER,
TGT.DEBIT_ORDER_SEQUENCE_NUMBER=SRC.DEBIT_ORDER_SEQUENCE_NUMBER,
TGT.DEBIT_CHECK_NUMBER=SRC.DEBIT_CHECK_NUMBER,
TGT.LI1_AGMT_SOURCE_SYSTEM=SRC.LI1_AGMT_SOURCE_SYSTEM,
TGT.LI1_COMPANY_ID=SRC.LI1_COMPANY_ID,
TGT.LI1_PRODUCT_TYPE=SRC.LI1_PRODUCT_TYPE,
TGT.LI1_POLICY_PREFIX=SRC.LI1_POLICY_PREFIX,
TGT.LI1_AGMT_NUMBER=SRC.LI1_AGMT_NUMBER,
TGT.LI1_AGMT_STATE_CODE=SRC.LI1_AGMT_STATE_CODE,
TGT.LI1_LINE_ITEM_AMOUNT=SRC.LI1_LINE_ITEM_AMOUNT,
TGT.LI2_AGMT_SOURCE_SYSTEM=SRC.LI2_AGMT_SOURCE_SYSTEM,
TGT.LI2_COMPANY_ID=SRC.LI2_COMPANY_ID,
TGT.LI2_PRODUCT_TYPE=SRC.LI2_PRODUCT_TYPE,
TGT.LI2_POLICY_PREFIX=SRC.LI2_POLICY_PREFIX,
TGT.LI2_AGMT_NUMBER=SRC.LI2_AGMT_NUMBER,
TGT.LI2_AGMT_STATE_CODE=SRC.LI2_AGMT_STATE_CODE,
TGT.LI2_LINE_ITEM_AMOUNT=SRC.LI2_LINE_ITEM_AMOUNT,
TGT.LI3_AGMT_SOURCE_SYSTEM=SRC.LI3_AGMT_SOURCE_SYSTEM,
TGT.LI3_COMPANY_ID=SRC.LI3_COMPANY_ID,
TGT.LI3_PRODUCT_TYPE=SRC.LI3_PRODUCT_TYPE,
TGT.LI3_POLICY_PREFIX=SRC.LI3_POLICY_PREFIX,
TGT.LI3_AGMT_NUMBER=SRC.LI3_AGMT_NUMBER,
TGT.LI3_AGMT_STATE_CODE=SRC.LI3_AGMT_STATE_CODE,
TGT.LI3_LINE_ITEM_AMOUNT=SRC.LI3_LINE_ITEM_AMOUNT,
TGT.LI4_AGMT_SOURCE_SYSTEM=SRC.LI4_AGMT_SOURCE_SYSTEM,
TGT.LI4_COMPANY_ID=SRC.LI4_COMPANY_ID,
TGT.LI4_PRODUCT_TYPE=SRC.LI4_PRODUCT_TYPE,
TGT.LI4_POLICY_PREFIX=SRC.LI4_POLICY_PREFIX,
TGT.LI4_AGMT_NUMBER=SRC.LI4_AGMT_NUMBER,
TGT.LI4_AGMT_STATE_CODE=SRC.LI4_AGMT_STATE_CODE,
TGT.LI4_LINE_ITEM_AMOUNT=SRC.LI4_LINE_ITEM_AMOUNT,
TGT.LI5_AGMT_SOURCE_SYSTEM=SRC.LI5_AGMT_SOURCE_SYSTEM,
TGT.LI5_COMPANY_ID=SRC.LI5_COMPANY_ID,
TGT.LI5_PRODUCT_TYPE=SRC.LI5_PRODUCT_TYPE,
TGT.LI5_POLICY_PREFIX=SRC.LI5_POLICY_PREFIX,
TGT.LI5_AGMT_NUMBER=SRC.LI5_AGMT_NUMBER,
TGT.LI5_AGMT_STATE_CODE=SRC.LI5_AGMT_STATE_CODE,
TGT.LI5_LINE_ITEM_AMOUNT=SRC.LI5_LINE_ITEM_AMOUNT,
TGT.LI6_AGMT_SOURCE_SYSTEM=SRC.LI6_AGMT_SOURCE_SYSTEM,
TGT.LI6_COMPANY_ID=SRC.LI6_COMPANY_ID,
TGT.LI6_PRODUCT_TYPE=SRC.LI6_PRODUCT_TYPE,
TGT.LI6_POLICY_PREFIX=SRC.LI6_POLICY_PREFIX,
TGT.LI6_AGMT_NUMBER=SRC.LI6_AGMT_NUMBER,
TGT.LI6_AGMT_STATE_CODE=SRC.LI6_AGMT_STATE_CODE,
TGT.LI6_LINE_ITEM_AMOUNT=SRC.LI6_LINE_ITEM_AMOUNT,
TGT.LI7_AGMT_SOURCE_SYSTEM=SRC.LI7_AGMT_SOURCE_SYSTEM,
TGT.LI7_COMPANY_ID=SRC.LI7_COMPANY_ID,
TGT.LI7_PRODUCT_TYPE=SRC.LI7_PRODUCT_TYPE,
TGT.LI7_POLICY_PREFIX=SRC.LI7_POLICY_PREFIX,
TGT.LI7_AGMT_NUMBER=SRC.LI7_AGMT_NUMBER,
TGT.LI7_AGMT_STATE_CODE=SRC.LI7_AGMT_STATE_CODE,
TGT.LI7_LINE_ITEM_AMOUNT=SRC.LI7_LINE_ITEM_AMOUNT,
TGT.LI8_AGMT_SOURCE_SYSTEM=SRC.LI8_AGMT_SOURCE_SYSTEM,
TGT.LI8_COMPANY_ID=SRC.LI8_COMPANY_ID,
TGT.LI8_PRODUCT_TYPE=SRC.LI8_PRODUCT_TYPE,
TGT.LI8_POLICY_PREFIX=SRC.LI8_POLICY_PREFIX,
TGT.LI8_AGMT_NUMBER=SRC.LI8_AGMT_NUMBER,
TGT.LI8_AGMT_STATE_CODE=SRC.LI8_AGMT_STATE_CODE,
TGT.LI8_LINE_ITEM_AMOUNT=SRC.LI8_LINE_ITEM_AMOUNT,
TGT.LI9_AGMT_SOURCE_SYSTEM=SRC.LI9_AGMT_SOURCE_SYSTEM,
TGT.LI9_COMPANY_ID=SRC.LI9_COMPANY_ID,
TGT.LI9_PRODUCT_TYPE=SRC.LI9_PRODUCT_TYPE,
TGT.LI9_POLICY_PREFIX=SRC.LI9_POLICY_PREFIX,
TGT.LI9_AGMT_NUMBER=SRC.LI9_AGMT_NUMBER,
TGT.LI9_AGMT_STATE_CODE=SRC.LI9_AGMT_STATE_CODE,
TGT.LI9_LINE_ITEM_AMOUNT=SRC.LI9_LINE_ITEM_AMOUNT,
TGT.LI10_AGMT_SOURCE_SYSTEM=SRC.LI10_AGMT_SOURCE_SYSTEM,
TGT.LI10_COMPANY_ID=SRC.LI10_COMPANY_ID,
TGT.LI10_PRODUCT_TYPE=SRC.LI10_PRODUCT_TYPE,
TGT.LI10_POLICY_PREFIX=SRC.LI10_POLICY_PREFIX,
TGT.LI10_AGMT_NUMBER=SRC.LI10_AGMT_NUMBER,
TGT.LI10_AGMT_STATE_CODE=SRC.LI10_AGMT_STATE_CODE,
TGT.LI10_LINE_ITEM_AMOUNT=SRC.LI10_LINE_ITEM_AMOUNT,
TGT.ADJUSTMENT_CHECK_AMT=SRC.ADJUSTMENT_CHECK_AMT,
TGT.POLICYADJUSTMENT_CASH_AMT=SRC.POLICYADJUSTMENT_CASH_AMT,
TGT.POLICYADJUSTMENT_CRDT_AMT=SRC.POLICYADJUSTMENT_CRDT_AMT,
TGT.JOB_RUN_ID=SRC.JOB_RUN_ID,
TGT.SOURCE_SYSTEM_CD=SRC.SOURCE_SYSTEM_CD
WHEN NOT MATCHED THEN
  INSERT (
POS_INSURANCE_PAYMENTS_ID,
EXTERNAL_REFERENCE_NUMBER,
POS_TRANSACTION_ID,
RECORD_IDENTIFIER,
BRANCH_NUMBER,
BRANCH_HUB_NUMBER,
BRANCH_DEVICE_NUMBER,
CLUB_CODE,
USER_ID,
TRANSACTION_DATE,
TRANSACTION_TIME,
TRANSACTION_POSTMARK_DATE,
TRANSACTION_TOTAL_AMOUNT,
CASH_TRANSACTION_FOP,
CASH_FOP_AMOUNT,
CASH_PAYMENT_CARD_TYPE,
CASH_PAYMENT_CARD_LAST4,
CASH_PYMT_CARD_EXPIRATION_MON,
CASH_PYMT_CARD_EXPIRATION_YR,
CASH_ORDER_NUMBER,
CASH_ORDER_SEQUENCE_NUMBER,
CASH_CHECK_NUMBER,
CHCK_TRANSACTION_FOP,
CHCK_FOP_AMOUNT,
CHCK_PAYMENT_CARD_TYPE,
CHCK_PAYMENT_CARD_LAST4,
CHCK_PYMT_CARD_EXPIRATION_MON,
CHCK_PYMT_CARD_EXPIRATION_YR,
CHCK_ORDER_NUMBER,
CHCK_ORDER_SEQUENCE_NUMBER,
CHCK_CHECK_NUMBER,
VISA_TRANSACTION_FOP,
VISA_FOP_AMOUNT,
VISA_PAYMENT_CARD_TYPE,
VISA_PAYMENT_CARD_LAST4,
VISA_PYMT_CARD_EXPIRATION_MON,
VISA_PYMT_CARD_EXPIRATION_YR,
VISA_ORDER_NUMBER,
VISA_ORDER_SEQUENCE_NUMBER,
VISA_CHECK_NUMBER,
MASTER_TRANSACTION_FOP,
MASTER_FOP_AMOUNT,
MASTER_PAYMENT_CARD_TYPE,
MASTER_PAYMENT_CARD_LAST4,
MSTR_PYMT_CARD_EXPIRATION_MON,
MSTR_PYMT_CARD_EXPIRATION_YR,
MASTER_ORDER_NUMBER,
MASTER_ORDER_SEQUENCE_NUMBER,
MASTER_CHECK_NUMBER,
DEBIT_TRANSACTION_FOP,
DEBIT_FOP_AMOUNT,
DEBIT_PAYMENT_CARD_TYPE,
DEBIT_PAYMENT_CARD_LAST4,
DEBIT_PYMT_CARD_EXPIRATION_MON,
DEBIT_PYMT_CARD_EXPIRATION_YR,
DEBIT_ORDER_NUMBER,
DEBIT_ORDER_SEQUENCE_NUMBER,
DEBIT_CHECK_NUMBER,
LI1_AGMT_SOURCE_SYSTEM,
LI1_COMPANY_ID,
LI1_PRODUCT_TYPE,
LI1_POLICY_PREFIX,
LI1_AGMT_NUMBER,
LI1_AGMT_STATE_CODE,
LI1_LINE_ITEM_AMOUNT,
LI2_AGMT_SOURCE_SYSTEM,
LI2_COMPANY_ID,
LI2_PRODUCT_TYPE,
LI2_POLICY_PREFIX,
LI2_AGMT_NUMBER,
LI2_AGMT_STATE_CODE,
LI2_LINE_ITEM_AMOUNT,
LI3_AGMT_SOURCE_SYSTEM,
LI3_COMPANY_ID,
LI3_PRODUCT_TYPE,
LI3_POLICY_PREFIX,
LI3_AGMT_NUMBER,
LI3_AGMT_STATE_CODE,
LI3_LINE_ITEM_AMOUNT,
LI4_AGMT_SOURCE_SYSTEM,
LI4_COMPANY_ID,
LI4_PRODUCT_TYPE,
LI4_POLICY_PREFIX,
LI4_AGMT_NUMBER,
LI4_AGMT_STATE_CODE,
LI4_LINE_ITEM_AMOUNT,
LI5_AGMT_SOURCE_SYSTEM,
LI5_COMPANY_ID,
LI5_PRODUCT_TYPE,
LI5_POLICY_PREFIX,
LI5_AGMT_NUMBER,
LI5_AGMT_STATE_CODE,
LI5_LINE_ITEM_AMOUNT,
LI6_AGMT_SOURCE_SYSTEM,
LI6_COMPANY_ID,
LI6_PRODUCT_TYPE,
LI6_POLICY_PREFIX,
LI6_AGMT_NUMBER,
LI6_AGMT_STATE_CODE,
LI6_LINE_ITEM_AMOUNT,
LI7_AGMT_SOURCE_SYSTEM,
LI7_COMPANY_ID,
LI7_PRODUCT_TYPE,
LI7_POLICY_PREFIX,
LI7_AGMT_NUMBER,
LI7_AGMT_STATE_CODE,
LI7_LINE_ITEM_AMOUNT,
LI8_AGMT_SOURCE_SYSTEM,
LI8_COMPANY_ID,
LI8_PRODUCT_TYPE,
LI8_POLICY_PREFIX,
LI8_AGMT_NUMBER,
LI8_AGMT_STATE_CODE,
LI8_LINE_ITEM_AMOUNT,
LI9_AGMT_SOURCE_SYSTEM,
LI9_COMPANY_ID,
LI9_PRODUCT_TYPE,
LI9_POLICY_PREFIX,
LI9_AGMT_NUMBER,
LI9_AGMT_STATE_CODE,
LI9_LINE_ITEM_AMOUNT,
LI10_AGMT_SOURCE_SYSTEM,
LI10_COMPANY_ID,
LI10_PRODUCT_TYPE,
LI10_POLICY_PREFIX,
LI10_AGMT_NUMBER,
LI10_AGMT_STATE_CODE,
LI10_LINE_ITEM_AMOUNT,
ADJUSTMENT_CHECK_AMT,
POLICYADJUSTMENT_CASH_AMT,
POLICYADJUSTMENT_CRDT_AMT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME
)
VALUES (
SRC.POS_INSURANCE_PAYMENTS_ID + (SELECT IFNULL(MAX(POS_INSURANCE_PAYMENTS_ID),0) FROM OPERATIONAL.STAGE_POS_INSURANCE_PAYMENTS),
SRC.EXTERNAL_REFERENCE_NUMBER,
SRC.POS_TRANSACTION_ID,
SRC.RECORD_IDENTIFIER,
SRC.BRANCH_NUMBER,
SRC.BRANCH_HUB_NUMBER,
SRC.BRANCH_DEVICE_NUMBER,
SRC.CLUB_CODE,
SRC.USER_ID,
SRC.TRANSACTION_DATE,
SRC.TRANSACTION_TIME,
SRC.TRANSACTION_POSTMARK_DATE,
SRC.TRANSACTION_TOTAL_AMOUNT,
SRC.CASH_TRANSACTION_FOP,
SRC.CASH_FOP_AMOUNT,
SRC.CASH_PAYMENT_CARD_TYPE,
SRC.CASH_PAYMENT_CARD_LAST4,
SRC.CASH_PYMT_CARD_EXPIRATION_MON,
SRC.CASH_PYMT_CARD_EXPIRATION_YR,
SRC.CASH_ORDER_NUMBER,
SRC.CASH_ORDER_SEQUENCE_NUMBER,
SRC.CASH_CHECK_NUMBER,
SRC.CHCK_TRANSACTION_FOP,
SRC.CHCK_FOP_AMOUNT,
SRC.CHCK_PAYMENT_CARD_TYPE,
SRC.CHCK_PAYMENT_CARD_LAST4,
SRC.CHCK_PYMT_CARD_EXPIRATION_MON,
SRC.CHCK_PYMT_CARD_EXPIRATION_YR,
SRC.CHCK_ORDER_NUMBER,
SRC.CHCK_ORDER_SEQUENCE_NUMBER,
SRC.CHCK_CHECK_NUMBER,
SRC.VISA_TRANSACTION_FOP,
SRC.VISA_FOP_AMOUNT,
SRC.VISA_PAYMENT_CARD_TYPE,
SRC.VISA_PAYMENT_CARD_LAST4,
SRC.VISA_PYMT_CARD_EXPIRATION_MON,
SRC.VISA_PYMT_CARD_EXPIRATION_YR,
SRC.VISA_ORDER_NUMBER,
SRC.VISA_ORDER_SEQUENCE_NUMBER,
SRC.VISA_CHECK_NUMBER,
SRC.MASTER_TRANSACTION_FOP,
SRC.MASTER_FOP_AMOUNT,
SRC.MASTER_PAYMENT_CARD_TYPE,
SRC.MASTER_PAYMENT_CARD_LAST4,
SRC.MSTR_PYMT_CARD_EXPIRATION_MON,
SRC.MSTR_PYMT_CARD_EXPIRATION_YR,
SRC.MASTER_ORDER_NUMBER,
SRC.MASTER_ORDER_SEQUENCE_NUMBER,
SRC.MASTER_CHECK_NUMBER,
SRC.DEBIT_TRANSACTION_FOP,
SRC.DEBIT_FOP_AMOUNT,
SRC.DEBIT_PAYMENT_CARD_TYPE,
SRC.DEBIT_PAYMENT_CARD_LAST4,
SRC.DEBIT_PYMT_CARD_EXPIRATION_MON,
SRC.DEBIT_PYMT_CARD_EXPIRATION_YR,
SRC.DEBIT_ORDER_NUMBER,
SRC.DEBIT_ORDER_SEQUENCE_NUMBER,
SRC.DEBIT_CHECK_NUMBER,
SRC.LI1_AGMT_SOURCE_SYSTEM,
SRC.LI1_COMPANY_ID,
SRC.LI1_PRODUCT_TYPE,
SRC.LI1_POLICY_PREFIX,
SRC.LI1_AGMT_NUMBER,
SRC.LI1_AGMT_STATE_CODE,
SRC.LI1_LINE_ITEM_AMOUNT,
SRC.LI2_AGMT_SOURCE_SYSTEM,
SRC.LI2_COMPANY_ID,
SRC.LI2_PRODUCT_TYPE,
SRC.LI2_POLICY_PREFIX,
SRC.LI2_AGMT_NUMBER,
SRC.LI2_AGMT_STATE_CODE,
SRC.LI2_LINE_ITEM_AMOUNT,
SRC.LI3_AGMT_SOURCE_SYSTEM,
SRC.LI3_COMPANY_ID,
SRC.LI3_PRODUCT_TYPE,
SRC.LI3_POLICY_PREFIX,
SRC.LI3_AGMT_NUMBER,
SRC.LI3_AGMT_STATE_CODE,
SRC.LI3_LINE_ITEM_AMOUNT,
SRC.LI4_AGMT_SOURCE_SYSTEM,
SRC.LI4_COMPANY_ID,
SRC.LI4_PRODUCT_TYPE,
SRC.LI4_POLICY_PREFIX,
SRC.LI4_AGMT_NUMBER,
SRC.LI4_AGMT_STATE_CODE,
SRC.LI4_LINE_ITEM_AMOUNT,
SRC.LI5_AGMT_SOURCE_SYSTEM,
SRC.LI5_COMPANY_ID,
SRC.LI5_PRODUCT_TYPE,
SRC.LI5_POLICY_PREFIX,
SRC.LI5_AGMT_NUMBER,
SRC.LI5_AGMT_STATE_CODE,
SRC.LI5_LINE_ITEM_AMOUNT,
SRC.LI6_AGMT_SOURCE_SYSTEM,
SRC.LI6_COMPANY_ID,
SRC.LI6_PRODUCT_TYPE,
SRC.LI6_POLICY_PREFIX,
SRC.LI6_AGMT_NUMBER,
SRC.LI6_AGMT_STATE_CODE,
SRC.LI6_LINE_ITEM_AMOUNT,
SRC.LI7_AGMT_SOURCE_SYSTEM,
SRC.LI7_COMPANY_ID,
SRC.LI7_PRODUCT_TYPE,
SRC.LI7_POLICY_PREFIX,
SRC.LI7_AGMT_NUMBER,
SRC.LI7_AGMT_STATE_CODE,
SRC.LI7_LINE_ITEM_AMOUNT,
SRC.LI8_AGMT_SOURCE_SYSTEM,
SRC.LI8_COMPANY_ID,
SRC.LI8_PRODUCT_TYPE,
SRC.LI8_POLICY_PREFIX,
SRC.LI8_AGMT_NUMBER,
SRC.LI8_AGMT_STATE_CODE,
SRC.LI8_LINE_ITEM_AMOUNT,
SRC.LI9_AGMT_SOURCE_SYSTEM,
SRC.LI9_COMPANY_ID,
SRC.LI9_PRODUCT_TYPE,
SRC.LI9_POLICY_PREFIX,
SRC.LI9_AGMT_NUMBER,
SRC.LI9_AGMT_STATE_CODE,
SRC.LI9_LINE_ITEM_AMOUNT,
SRC.LI10_AGMT_SOURCE_SYSTEM,
SRC.LI10_COMPANY_ID,
SRC.LI10_PRODUCT_TYPE,
SRC.LI10_POLICY_PREFIX,
SRC.LI10_AGMT_NUMBER,
SRC.LI10_AGMT_STATE_CODE,
SRC.LI10_LINE_ITEM_AMOUNT,
SRC.ADJUSTMENT_CHECK_AMT,
SRC.POLICYADJUSTMENT_CASH_AMT,
SRC.POLICYADJUSTMENT_CRDT_AMT,
SRC.JOB_RUN_ID,
SRC.SOURCE_SYSTEM_CD,
CURRENT_DATETIME()
)
