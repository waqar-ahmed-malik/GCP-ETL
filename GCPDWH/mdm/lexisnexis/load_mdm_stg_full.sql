CREATE OR REPLACE TABLE LANDING.WORK_MDM_LEXISNEXIS_INDIVIDUAL AS 
SELECT
CAST(SOURCE_KEY1 AS STRING) as SOURCE_KEY1,
CAST(SOURCE_KEY2 AS STRING) as SOURCE_KEY2,
CAST(SOURCE_KEY3 AS STRING) as SOURCE_KEY3,
SOURCE_KEY1_COLUMN_NAME,
SOURCE_KEY2_COLUMN_NAME,	
SOURCE_KEY3_COLUMN_NAME,
SOURCE_SYSTEM,
FIRST_NM,
LAST_NM,
NAME_SUFFIX_CD,
SALUTATION_CD,
BIRTH_DATE,
GENDER_CD,
MARITAL_STATUS,
PRIMARY_ADDRESS_LINE1,
PRIMARY_ADDRESS_LINE2,
PRIMARY_CITY,
PRIMARY_STATE,
PRIMARY_ZIP,
PRIMARY_EMAIL_ADDRESS,
RESIDENTIAL_ADDRESS_LINE1,
RESIDENTIAL_ADDRESS_LINE2,
RESIDENTIAL_CITY,
RESIDENTIAL_STATE,
RESIDENTIAL_ZIP,
BILLING_ADDRESS_LINE1,
BILLING_ADDRESS_LINE2,
BILLING_CITY,
BILLING_STATE,
BILLING_ZIP,
OTHER_ADDRESS_LINE1,
OTHER_ADDRESS_LINE2,
OTHER_CITY,
OTHER_STATE,
OTHER_ZIP,
OTHER_EMAIL_ADDRESS,
HOME_TELEPHONE_NUM,
WORK_PHONE_NUM,
OTHER_PHONE_NUM,
SOURCE_CREATE_DATE
FROM (
SELECT
  DISTINCT
  TRIM(CID) AS SOURCE_KEY1,
  TRIM(NCNU_MEMBERSHIP_NUM) AS SOURCE_KEY2,
  CAST(NULL AS STRING) AS SOURCE_KEY3,
  'CID' AS SOURCE_KEY1_COLUMN_NAME,
  'NCNU_MEMBERSHIP_NUM' AS SOURCE_KEY2_COLUMN_NAME,	
  CAST(NULL AS STRING) AS SOURCE_KEY3_COLUMN_NAME,
  'LEXIS_NEXIS' AS SOURCE_SYSTEM,     
  UPPER(TRIM(STANDARD_FIRST_NM)) AS FIRST_NM ,  
  UPPER(TRIM(STANDARD_LAST_NM)) AS LAST_NM,
  CAST(NULL AS STRING) AS NAME_SUFFIX_CD,
  CAST(NULL AS STRING) AS SALUTATION_CD,
  EXTRACT(DATE FROM (BIRTH_DTTIME)) AS BIRTH_DATE,
  CAST(NULL AS STRING) AS GENDER_CD,
  TRIM(COMBINED_MARITAL_STATUS) AS MARITAL_STATUS,
  CASE WHEN STANDARD_ADDRESS_LINE1='' THEN NULL ELSE TRIM(STANDARD_ADDRESS_LINE1) END AS PRIMARY_ADDRESS_LINE1,
  CASE WHEN STANDARD_ADDRESS_LINE2='' THEN NULL ELSE TRIM(STANDARD_ADDRESS_LINE2) END AS PRIMARY_ADDRESS_LINE2,
  CASE WHEN STANDARD_CITY='' THEN NULL ELSE TRIM(STANDARD_CITY) END AS PRIMARY_CITY,
  CASE WHEN STANDARD_STATE='' THEN NULL ELSE TRIM(STANDARD_STATE) END AS PRIMARY_STATE,
  CASE WHEN STANDARD_ZIP='' THEN NULL ELSE TRIM(STANDARD_ZIP) END AS PRIMARY_ZIP,
  CAST(NULL AS STRING) AS PRIMARY_EMAIL_ADDRESS,
  CASE WHEN STANDARD_ADDRESS_LINE1='' THEN NULL ELSE TRIM(STANDARD_ADDRESS_LINE1) END AS RESIDENTIAL_ADDRESS_LINE1,
  CASE WHEN STANDARD_ADDRESS_LINE2='' THEN NULL ELSE TRIM(STANDARD_ADDRESS_LINE2) END AS RESIDENTIAL_ADDRESS_LINE2,
  TRIM(STANDARD_CITY) AS RESIDENTIAL_CITY,
  TRIM(STANDARD_STATE) AS RESIDENTIAL_STATE,
  TRIM(STANDARD_ZIP) AS RESIDENTIAL_ZIP,
  CAST(NULL AS STRING) AS BILLING_ADDRESS_LINE1,
  CAST(NULL AS STRING) AS BILLING_ADDRESS_LINE2,
  CAST(NULL AS STRING) AS BILLING_CITY,
  CAST(NULL AS STRING) AS BILLING_STATE,
  CAST(NULL AS STRING) AS BILLING_ZIP,
  CAST(NULL AS STRING) AS OTHER_ADDRESS_LINE1,
  CAST(NULL AS STRING) AS OTHER_ADDRESS_LINE2,
  CAST(NULL AS STRING) AS OTHER_CITY,
  CAST(NULL AS STRING) AS OTHER_STATE,
  CAST(NULL AS STRING) AS OTHER_ZIP,
  CAST(NULL AS STRING) AS OTHER_EMAIL_ADDRESS,
  TRIM(COMBINED_PHONE) AS HOME_TELEPHONE_NUM,
  CAST(NULL AS STRING) AS WORK_PHONE_NUM,
  CAST(NULL AS STRING) AS OTHER_PHONE_NUM,
  CURRENT_DATE() AS SOURCE_CREATE_DATE
FROM DIGITAL_MARKETING.DIRECT_FOCUS_INDIVIDUAL_DIM
WHERE ACTIVE_FLG='Y'
)  