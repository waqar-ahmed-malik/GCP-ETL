INSERT INTO CUSTOMER_PRODUCT.CHASE_PAYMENTS
(
RECORD_TYPE,
SUBMISSION_DT,
PID,
PID_SHORT_NM,
SUBMISSION_NUM,
RECORD_NUM,
ENTITY_TYPE,
ENTITY_NUM,
PRESENTMENT_CURRENCY,
MERCHANT_ORDER_NUM,
RDFI_NUM,
ACCOUNT_NUM,
EXPIRATION_DT,
AMOUNT,
MOP,
ACTION_CD,
AUTH_DT,
AUTH_CD,
AUTH_RESPONSE_CD,
TRACE_NUM,
CONSUMER_COUNTRY_CD,
RESERVED,
MCC,
TOKEN_IND,
CASH_BACK_AMT,
SURCHARGE_AMT,
VOUCHER_NUM,
EBT_ACCOUNT_TYPE,
INTERCHANGE_QUALIFICATION_CD,
DURBIN_REGULATED,
INTERCHANGE_UNIT_FEE,
INTERCHANGE_PERCENTAGE_FEE,
TOTAL_INTERCHANGE_AMT,
TOTAL_ASSESSMENT_AMT,
OTHR_DEBIT_PASSTHROUGH_FEE,
SETTLEMENT_CURRENCY,
PROCESSED_IND,
HPID,
FILE_ID,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DT,
CREATE_BY,
MERCHANT_ORDER_SOURCE,
PAYMENT_ID
)
SELECT
RECORD_TYPE AS RECORD_TYPE,
PARSE_DATE('%m/%d/%Y',SUBMISSION_DT) AS SUBMISSION_DT,
PID AS PID,
PID_SHORT_NM AS PID_SHORT_NM,
SUBMISSION_NUM AS SUBMISSION_NUM,
RECORD_NUM AS RECORD_NUM,
ENTITY_TYPE AS ENTITY_TYPE,
ENTITY_NUM AS ENTITY_NUM,
PRESENTMENT_CURRENCY AS PRESENTMENT_CURRENCY,
MERCHANT_ORDER_NUM AS MERCHANT_ORDER_NUM,
RDFI_NUM AS RDFI_NUM,
ACCOUNT_NUM AS ACCOUNT_NUM,
EXPIRATION_DT AS EXPIRATION_DT,
AMOUNT AS AMOUNT,
MOP AS MOP,
ACTION_CD AS ACTION_CD,
PARSE_DATE('%m/%d/%Y',AUTH_DT) AS AUTH_DT,
AUTH_CD AS AUTH_CD,
AUTH_RESPONSE_CD AS AUTH_RESPONSE_CD,
TRACE_NUM AS TRACE_NUM,
CONSUMER_COUNTRY_CD AS CONSUMER_COUNTRY_CD,
RESERVED AS RESERVED,
MCC AS MCC,
TOKEN_IND AS TOKEN_IND,
CASH_BACK_AMT AS CASH_BACK_AMT,
SURCHARGE_AMT AS SURCHARGE_AMT,
VOUCHER_NUM AS VOUCHER_NUM,
EBT_ACCOUNT_TYPE AS EBT_ACCOUNT_TYPE,
INTERCHANGE_QUALIFICATION_CD AS INTERCHANGE_QUALIFICATION_CD,
DURBIN_REGULATED AS DURBIN_REGULATED,
INTERCHANGE_UNIT_FEE AS INTERCHANGE_UNIT_FEE,
INTERCHANGE_PERCENTAGE_FEE AS INTERCHANGE_PERCENTAGE_FEE,
TOTAL_INTERCHANGE_AMT AS TOTAL_INTERCHANGE_AMT,
TOTAL_ASSESSMENT_AMT AS TOTAL_ASSESSMENT_AMT,
OTHR_DEBIT_PASSTHROUGH_FEE AS OTHR_DEBIT_PASSTHROUGH_FEE,
SETTLEMENT_CURRENCY AS SETTLEMENT_CURRENCY,
"N" AS PROCESSED_IND,
SUBSTR(SUBMISSION_DT,5) AS HPID,
FILE_ID,
"v_job_run_id",
"CHASE" AS SOURCE_SYSTEM_CD,
CURRENT_DATE() AS CREATE_DT,
"v_job_name" AS CREATE_BY,
CASE WHEN MERCHANT_ORDER_NUM like 'M%'
THEN 'ConnectSuite'
ELSE 'Other'
END AS MERCHANT_ORDER_SOURCE,
 CASE
    WHEN PAYMENTS.MAX_ID IS NULL THEN 0+(ROW_NUMBER() OVER ())
    ELSE PAYMENTS.MAX_ID+(ROW_NUMBER() OVER ())
  END AS PAYMENT_ID
FROM LANDING.WORK_CHASE_PAYMENTS,
(
  SELECT
    MAX(PAYMENT_ID) MAX_ID
  FROM
    CUSTOMER_PRODUCT.CHASE_PAYMENTS ) PAYMENTS