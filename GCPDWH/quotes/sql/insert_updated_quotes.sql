INSERT INTO `CUSTOMER_PRODUCT.QUOTES_DIM` (
QUOTE_NUM,
POLICY_NUM,
CREATE_DT ,
UPDATE_DT,
EFFECTIVE_DT,
QUOTE_ID,
OPPORTUNITY_ID,
CUSTOMER_ID,
SOURCE_CUSTOMER_ID,
POLICY_STATUS,
PRODUCT_TYPE,
PRODUCT_CD,
POLICY_STATE,
PREMIUM,
POLICY_TERM_MONTHS,
POLICY_CARRIER,
SOURCE_SYSTEM,
CURRENT_IMAGE_IND,
AGE_OF_QUOTE,
QUOTE_VERSION_AGE,
QUOTE_COUNT,
UPLOAD_COUNT,
QUOTE_STATUS,
TRANSACTION_TYPE,
BINDING_AGENT,
AGENT_OF_RECORD,
PRODUCER_EMAIL,
EMPLOYEE_ID,
CHANNEL_TYPE,
AGENCY_NM,
SALES_CHANNEL,
AGENCY_LOCATION_NM,
AGENCY_LOCATION_ID,
LEAD_SOURCE,
QUOTE_TYPE,
CONVERSION_DT,
IMPORTED_FLAG,
PRIOR_POLICY_NUM,
PRIOR_INSURANCE_COMPANY,
PRIOR_CARRIER_BI_LIMIT,
DAYS_LAPSED,
HOME_OWNER_TYPE,
ASSOCIATION,
MEMBERSHIP_NUM,
TIER,
AGENT_NOTE,
UW_NOTE,
LICENSE_STATUS_INFORMATION,
CLUE_INFORMATION,
VEHICLE_USAGE,
OTHER_NOTES,
FR_LEVEL,
GENDER,
TOLL_FREE_NUM,
INSERT_DT,
INSERT_BY,
LAST_UPDATED_AGENT,
LAST_UPDATED_DT,
VOICE_BIND,
PACKAGE_TYPE,
TXN_TYPE_IND,
MDM_CUSTOMER_KEY,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATED_DT,
CREATE_BY,
SELLING_LOCATION_ID,
REVENUE_LOCATION_ID,
COMPENSATION_EMPLOYEE_ID,
PROCESSED_EMPLOYEE_ID,
HASH_VALUE,
ROW_START_DT,
ROW_END_DT)
SELECT 
STG.QUOTE_NUM,
STG.POLICY_NUM,
STG.CREATE_DT ,
STG.UPDATE_DT,
STG.EFFECTIVE_DT,
STG.QUOTE_ID,
STG.OPPORTUNITY_ID,
STG.CUSTOMER_ID,
STG.SOURCE_CUSTOMER_ID,
STG.POLICY_STATUS,
STG.PRODUCT_TYPE,
STG.PRODUCT_CD,
STG.POLICY_STATE,
STG.PREMIUM,
STG.POLICY_TERM_MONTHS,
STG.POLICY_CARRIER,
STG.SOURCE_SYSTEM,
STG.CURRENT_IMAGE_IND,
STG.AGE_OF_QUOTE,
STG.QUOTE_VERSION_AGE,
STG.QUOTE_COUNT,
STG.UPLOAD_COUNT,
STG.QUOTE_STATUS,
STG.TRANSACTION_TYPE,
STG.BINDING_AGENT,
STG.AGENT_OF_RECORD,
STG.PRODUCER_EMAIL,
STG.EMPLOYEE_ID,
STG.CHANNEL_TYPE,
STG.AGENCY_NM,
STG.SALES_CHANNEL,
STG.AGENCY_LOCATION_NM,
STG.AGENCY_LOCATION_ID,
STG.LEAD_SOURCE,
STG.QUOTE_TYPE,
STG.CONVERSION_DT,
STG.IMPORTED_FLAG,
STG.PRIOR_POLICY_NUM,
STG.PRIOR_INSURANCE_COMPANY,
STG.PRIOR_CARRIER_BI_LIMIT,
STG.DAYS_LAPSED,
STG.HOME_OWNER_TYPE,
STG.ASSOCIATION,
STG.MEMBERSHIP_NUM,
STG.TIER,
STG.AGENT_NOTE,
STG.UW_NOTE,
STG.LICENSE_STATUS_INFORMATION,
STG.CLUE_INFORMATION,
STG.VEHICLE_USAGE,
STG.OTHER_NOTES,
STG.FR_LEVEL,
STG.GENDER,
STG.TOLL_FREE_NUM,
STG.INSERT_DT,
STG.INSERT_BY,
STG.LAST_UPDATED_AGENT,
STG.LAST_UPDATED_DT,
STG.VOICE_BIND,
STG.PACKAGE_TYPE,
STG.TXN_TYPE_IND,
STG.MDM_CUSTOMER_KEY,
STG.JOB_RUN_ID,
STG.SOURCE_SYSTEM_CD,
STG.CREATED_DT,
STG.CREATE_BY,
STG.SELLING_LOCATION_ID,
STG.REVENUE_LOCATION_ID,
STG.COMPENSATION_EMPLOYEE_ID ,
STG.PROCESSED_EMPLOYEE_ID,
STG.MD5_VALUE,
STG.LAST_UPDATED_DT,
PARSE_DATE("%Y-%m-%d",'9999-12-31')
from `LANDING.WORK_QUOTES_DIM` STG
INNER JOIN `CUSTOMER_PRODUCT.QUOTES_DIM` DIM
ON DIM.QUOTE_NUM = STG.QUOTE_NUM WHERE TO_BASE64(STG.MD5_VALUE) <> TO_BASE64(DIM.HASH_VALUE) AND DIM.ROW_END_DT = '9999-12-31'