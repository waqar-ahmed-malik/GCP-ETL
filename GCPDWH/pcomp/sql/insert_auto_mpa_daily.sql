INSERT INTO LANDING.PCOMP_AUTO_MPA_DAILY
(
STAGEKEY,
BATCH_NM,
SOURCE_SYSTEM,
LOAD_DT,
POL_NUM,
MEMBERSHIP_NUM,
EFF_DT,
CANCEL_DT,
RENEW_COUNT,
RENEWED,
POL_TYPE,
TRANSACTION_TYPE,
VIN01,
VIN02,
VIN03,
VIN04,
VIN05,
VIN06,
VIN07,
VIN08,
VIN09,
VIN10,
DL01,
DL02,
DL03,
DL04,
DL05,
DL06,
DL07,
DL08,
DL09,
DL10,
FILLER,
ETL_JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DT,
CREATED_BY
)
SELECT 
 CASE
     WHEN PCOMP.MAX_ID IS NULL THEN 0+(ROW_NUMBER() OVER ())
     ELSE PCOMP.MAX_ID+(ROW_NUMBER() OVER ())
   END AS STAGEKEY,
CONCAT('BATCH',CAST(CURRENT_DATE() AS STRING)),
'Exigen',
CURRENT_DATE(),
ZDRVVIN_POL_NUM,
ZDRVVIN_MEMBERSHIP_NUM,
PARSE_DATE('%m/%d/%Y',ZDRVVIN_POL_EFF_DT),
PARSE_DATE('%m/%d/%Y',ZDRVVIN_POL_CAN_DT),
ZDRVVIN_RENEWAL_CNT,
ZDRVVIN_REN_NEW_IND,
ZDRVVIN_POL_TYPE,
ZDRVVIN_TRAN_TYPE,
ZDRVVIN_VIN_NUM1,
ZDRVVIN_VIN_NUM2,
ZDRVVIN_VIN_NUM3,
ZDRVVIN_VIN_NUM4,
ZDRVVIN_VIN_NUM5,
ZDRVVIN_VIN_NUM6,
ZDRVVIN_VIN_NUM7,
ZDRVVIN_VIN_NUM8,
ZDRVVIN_VIN_NUM9,
ZDRVVIN_VIN_NUM10,
ZDRVVIN_DRV_LIC_NUM1,
ZDRVVIN_DRV_LIC_NUM2,
ZDRVVIN_DRV_LIC_NUM3,
ZDRVVIN_DRV_LIC_NUM4,
ZDRVVIN_DRV_LIC_NUM5,
ZDRVVIN_DRV_LIC_NUM6,
ZDRVVIN_DRV_LIC_NUM7,
ZDRVVIN_DRV_LIC_NUM8,
ZDRVVIN_DRV_LIC_NUM9,
ZDRVVIN_DRV_LIC_NUM10,
FILLER,
"v_job_run_id" AS ETL_JOB_RUN_ID,
 "PCOMP" AS SOURCE_SYSTEM_CD,
    CURRENT_DATE() AS CREATE_DT,
    "v_job_name" AS CREATED_BY
FROM LANDING.WORK_PCOMP_AUTO_MPA_DAILY,
(
   SELECT
     MAX(STAGEKEY) MAX_ID
   FROM
     LANDING.PCOMP_AUTO_MPA_DAILY ) PCOMP