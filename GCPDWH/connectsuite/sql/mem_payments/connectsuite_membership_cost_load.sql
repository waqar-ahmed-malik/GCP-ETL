MERGE INTO OPERATIONAL.CONNECTSUITE_MEMBERSHIP_COST M
USING LANDING.WORK_CS_MEMBERSHIP_COST W
ON M.MEMBERSHIP_COST_KEY =SAFE_CAST(W.MEMBERSHIP_COST_KEY AS INT64)
WHEN NOT MATCHED THEN
INSERT
(
MEMBERSHIP_COST_KEY,
MEMBERSHIP_COST_COMP_CD,
MEMBERSHIP_COST_AMT,
MEMBERSHIP_COST_STS_CD,
MEMBERSHIP_KEY,
MEMBER_KEY,
RIDE_KEY,
MEMBERSHIP_COST_COLT_AMT,
MEMBERSHIP_COST_REFUND_AMT,
MEMBERSHIP_COST_EFF_DTTIME,
MEMBERSHIP_COST_CANC_DTTIME,
MEMBERSHIP_COST_REINST_IND,
MEMBERSHIP_COST_REINST_DTTIME,
MEMBERSHIP_COST_PAYEE_CD,
MEMBERSHIP_COST_PRIM_PMT_AMT,
MEMBERSHIP_COST_DNR_PMT_AMT,
MEMBERSHIP_COST_PRIM_CRD_AMT,
MEMBERSHIP_COST_DNR_CRD_AMT,
MEMBERSHIP_COST_PAYBACK_REQ_IND,
MEMBERSHIP_COST_ACTV_DTTIME,
CCST_KEY,
MEMBERSHIP_COST_PRIM_EXCL_CRD_AMT,
MEMBERSHIP_COST_DNR_EXCL_CRD_AMT,
ETL_JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DTTIME,
CREATED_BY,
UPDATE_DTTIME
)
VALUES
(
CAST(MEMBERSHIP_COST_KEY AS INT64),
MEMBERSHIP_COST_COMP_CD,
CAST(MEMBERSHIP_COST_AMT AS FLOAT64),
MEMBERSHIP_COST_STS_CD,
CAST(MEMBERSHIP_KEY AS INT64),
CAST(MEMBER_KEY AS INT64),
CAST(RIDE_KEY AS INT64),
CAST(MEMBERSHIP_COST_COLT_AMT AS FLOAT64),
CAST(MEMBERSHIP_COST_REFUND_AMT AS FLOAT64),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',MEMBERSHIP_COST_EFF_DTTIME),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',MEMBERSHIP_COST_CANC_DTTIME),
MEMBERSHIP_COST_REINST_IND,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',MEMBERSHIP_COST_REINST_DTTIME),
MEMBERSHIP_COST_PAYEE_CD,
CAST(MEMBERSHIP_COST_PRIM_PMT_AMT AS FLOAT64),
CAST(MEMBERSHIP_COST_DNR_PMT_AMT AS FLOAT64),
CAST(MEMBERSHIP_COST_PRIM_CRD_AMT AS FLOAT64),
CAST(MEMBERSHIP_COST_DNR_CRD_AMT AS FLOAT64),
MEMBERSHIP_COST_PAYBACK_REQ_IND,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',MEMBERSHIP_COST_ACTV_DTTIME),
CAST(CCST_KEY AS INT64),
CAST(MEMBERSHIP_COST_PRIM_EXCL_CRD_AMT AS FLOAT64),
CAST(MEMBERSHIP_COST_DNR_EXCL_CRD_AMT AS FLOAT64),
CAST('jobrunid' AS INT64),
'CONNECT SUITE',
CURRENT_DATETIME(),
'jobname',
CURRENT_DATETIME()
)
WHEN MATCHED THEN 
UPDATE
SET
MEMBERSHIP_COST_COMP_CD = W.MEMBERSHIP_COST_COMP_CD,
MEMBERSHIP_COST_AMT = CAST(W.MEMBERSHIP_COST_AMT AS FLOAT64),
MEMBERSHIP_COST_STS_CD = W.MEMBERSHIP_COST_STS_CD,
MEMBERSHIP_KEY = CAST(W.MEMBERSHIP_KEY AS INT64),
MEMBER_KEY = CAST(W.MEMBER_KEY AS INT64),
RIDE_KEY = CAST(W.RIDE_KEY AS INT64),
MEMBERSHIP_COST_COLT_AMT = CAST(W.MEMBERSHIP_COST_COLT_AMT AS FLOAT64),
MEMBERSHIP_COST_REFUND_AMT = CAST(W.MEMBERSHIP_COST_REFUND_AMT AS FLOAT64),
MEMBERSHIP_COST_EFF_DTTIME = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',W.MEMBERSHIP_COST_EFF_DTTIME),
MEMBERSHIP_COST_CANC_DTTIME = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',W.MEMBERSHIP_COST_CANC_DTTIME),
MEMBERSHIP_COST_REINST_IND = W.MEMBERSHIP_COST_REINST_IND,
MEMBERSHIP_COST_REINST_DTTIME = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',W.MEMBERSHIP_COST_REINST_DTTIME),
MEMBERSHIP_COST_PAYEE_CD = W.MEMBERSHIP_COST_PAYEE_CD,
MEMBERSHIP_COST_PRIM_PMT_AMT = CAST(W.MEMBERSHIP_COST_PRIM_PMT_AMT AS FLOAT64),
MEMBERSHIP_COST_DNR_PMT_AMT = CAST(W.MEMBERSHIP_COST_DNR_PMT_AMT AS FLOAT64),
MEMBERSHIP_COST_PRIM_CRD_AMT = CAST(W.MEMBERSHIP_COST_PRIM_CRD_AMT AS FLOAT64),
MEMBERSHIP_COST_DNR_CRD_AMT = CAST(W.MEMBERSHIP_COST_DNR_CRD_AMT AS FLOAT64),
MEMBERSHIP_COST_PAYBACK_REQ_IND = W.MEMBERSHIP_COST_PAYBACK_REQ_IND,
MEMBERSHIP_COST_ACTV_DTTIME = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',W.MEMBERSHIP_COST_ACTV_DTTIME),
CCST_KEY = CAST(W.CCST_KEY AS INT64),
MEMBERSHIP_COST_PRIM_EXCL_CRD_AMT = CAST(W.MEMBERSHIP_COST_PRIM_EXCL_CRD_AMT AS FLOAT64),
MEMBERSHIP_COST_DNR_EXCL_CRD_AMT = CAST(W.MEMBERSHIP_COST_DNR_EXCL_CRD_AMT AS FLOAT64),
ETL_JOB_RUN_ID = CAST('jobrunid' AS INT64),
SOURCE_SYSTEM_CD = 'CONNECT SUITE',
CREATED_BY = 'jobname',
UPDATE_DTTIME= CURRENT_DATETIME()