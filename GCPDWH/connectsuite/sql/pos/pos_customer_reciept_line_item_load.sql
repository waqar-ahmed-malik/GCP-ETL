MERGE OPERATIONAL.POS_CUSTOMER_RECEIPT_LINE_ITEMS A
USING LANDING.WORK_POS_CUSTOMER_RECIEPT_LINE_ITEMS B
ON  A.SALE_ID= CAST(B.SALE_ID AS INT64)
AND A.CUST_RECEIPT_LN_ITM_ID= CAST( B.CUST_RECPT_LN_ITM_ID AS INT64)
WHEN MATCHED THEN
UPDATE SET
A.INSURANCE_PAYMENT_ID = B.INSURANCE_PAYMENT_ID,
A.CUST_RECEIPT_LN_ITM_ID=CAST( B.CUST_RECPT_LN_ITM_ID AS INT64),
A.SOURCE_CD= B.SOURCE_CD,
A.ITEM_TYPE_ID= B.CUST_RECPT_LN_ITM_INV_ID,
A.ITEM_TYPE_TX= B.CUST_RECPT_LN_ITM_DSC_TX,
A.QUANTITY= CAST(B.CUST_RECPT_LN_ITM_QTY_CT AS INT64),
A.SHIPPING_AMT= CAST(B.SHIPPING_AMT AS FLOAT64),
A.SHIPPING_QTY= CAST(B.SHIPPING_QTY AS INT64),
A.HANDLING_AMT= CAST(B.HANDLING_AMT AS FLOAT64),
A.HANDLING_QTY= CAST(B.HANDLING_QTY AS INT64),
A.LIST_PRC = CAST(B.LIST_PRC AS FLOAT64),
A.NON_MEMBER_PRC= CAST(B.NONMEMBER_PRC AS FLOAT64),
A.MEMBER_PRC= CAST(B.MEMBER_PRC AS FLOAT64),
A.SALE_PRC= CAST(B.SALE_PRC AS FLOAT64),
A.SPECIAL_TAX_AMT= CAST(B.SPECIAL_TAX_AMT AS FLOAT64),
A.ITEM_TYPE_CD= B.INV_ITM_TYP,
A.ORD_FULFILLMENT_QTY= CAST(B.ORD_FULFILLMENT_QTY AS INT64),
A.INV_SKU_ID = CAST(B.INV_SKU_ID AS INT64),
A.INV_SKU_DESC= GL_ACCT_NR ,
A.ADDITIONAL_TXT= B.ITM_ADDITIONAL_INFO_TXT,
A.COMPANY_ID= B.COMPANY_ID,
A.SOURCE_SYSTEM= B.SOURCE_SYSTEM,
A.PRODUCT_TYPE= B.PRODUCT_TYPE,
A.PRODUCT_PREFIX= B.PRODUCT_PREFIX,
A.POLICY_NUM = B.POLICY_NUM,
A.STATE_CD= B.STATE_CD,
A.INSURANCE_PAYMENT_AMT = CAST(B.PAYMENT_AMT AS FLOAT64),
A.OFR_ID= CAST(B.OFR_ID AS INT64),
A.EMPLOYEE_PRC = CAST(B.EMPLOYEE_PRC AS FLOAT64),
A.GROUP_IND=CAST(B.GROUP_IND AS INT64),
A.CUST_RECPT_LN_ITM_UOM_CD=B.CUST_RECPT_LN_ITM_UOM_CD,
A.CUST_RECPT_LN_ITM_CHG_ITM = CAST(B.CUST_RECPT_LN_ITM_CHG_ITM AS INT64),
A.CUST_RECPT_LN_ITM_TAX_ITM = CAST(B.CUST_RECPT_LN_ITM_TAX_ITM AS INT64),
A.CUST_RECPT_VD_RET_IND=B.CUST_RECPT_VD_RET_IND,
A.CUST_RECPT_RET_RSN_CD = CAST(B.CUST_RECPT_RET_RSN_CD AS INT64),
A.CUST_RECPT_LN_ITM_SER_NR=B.CUST_RECPT_LN_ITM_SER_NR,
A.UPLOAD_TRANS_NR=CAST(B.UPLOAD_TRANS_NR AS INT64),
A.DYNAMIC_TYP=CAST(B.DYNAMIC_TYP AS INT64),
A.USER_STRING=B.USER_STRING,
A.USER_DT=CAST(B.USER_DT AS DATETIME),
A.USER_DEC=CAST(B.USER_DEC AS INT64),
A.PRODUCT_INCPL_IND=B.PRODUCT_INCPL_IND,
A.PRICE_OVERRIDE_IND=B.PRICE_OVERRIDE_IND,
A.INV_SER_ID=CAST(B.INV_SER_ID AS INT64),
A.LAST_UPDATE=CAST(B.LAST_UPDATE AS DATETIME),
A.INV_SKU_POSITION=CAST(B.INV_SKU_POSITION AS INT64)
WHEN NOT MATCHED THEN
  INSERT (
INSURANCE_PAYMENT_ID,
ASSOC_CD,
CLUB_CD,
OFFICE_ID,
SALE_ID,
CUST_RECEIPT_LN_ITM_ID,
SOURCE_CD,
ITEM_TYPE_ID,
ITEM_TYPE_TX,
QUANTITY,
SHIPPING_AMT,
SHIPPING_QTY,
HANDLING_AMT,
HANDLING_QTY,
LIST_PRC,
NON_MEMBER_PRC,
MEMBER_PRC,
SALE_PRC,
SPECIAL_TAX_AMT,
ITEM_TYPE_CD,
ORD_FULFILLMENT_QTY,
INV_SKU_ID,
INV_SKU_DESC,
ADDITIONAL_TXT,
COMPANY_ID,
SOURCE_SYSTEM,
PRODUCT_TYPE,
PRODUCT_PREFIX,
POLICY_NUM,
STATE_CD,
INSURANCE_PAYMENT_AMT,
OFR_ID,
EMPLOYEE_PRC,
GROUP_IND,
CUST_RECPT_LN_ITM_UOM_CD,
CUST_RECPT_LN_ITM_CHG_ITM,
CUST_RECPT_LN_ITM_TAX_ITM,
CUST_RECPT_VD_RET_IND,
CUST_RECPT_RET_RSN_CD,
CUST_RECPT_LN_ITM_SER_NR,
UPLOAD_TRANS_NR,
DYNAMIC_TYP,
USER_STRING,
USER_DT,
USER_DEC,
PRODUCT_INCPL_IND,
PRICE_OVERRIDE_IND,
INV_SER_ID,
LAST_UPDATE,
INV_SKU_POSITION,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DT
)
VALUES(
INSURANCE_PAYMENT_ID,
ASSOC_CD,
CLB_CD,
OFC_ID,
CAST(SALE_ID AS INT64),
CAST(CUST_RECPT_LN_ITM_ID AS INT64),
SOURCE_CD,
CUST_RECPT_LN_ITM_INV_ID,
CUST_RECPT_LN_ITM_DSC_TX,
CAST(CUST_RECPT_LN_ITM_QTY_CT AS INT64), 
CAST(SHIPPING_AMT AS FLOAT64),
CAST(SHIPPING_QTY AS INT64),
CAST(HANDLING_AMT AS FLOAT64) ,
CAST(HANDLING_QTY AS INT64) ,
CAST(LIST_PRC AS FLOAT64) ,
CAST(NONMEMBER_PRC AS FLOAT64) ,
CAST(MEMBER_PRC AS FLOAT64) ,
CAST(SALE_PRC AS FLOAT64) ,
CAST(SPECIAL_TAX_AMT AS FLOAT64) ,
INV_ITM_TYP,
CAST(ORD_FULFILLMENT_QTY AS INT64) ,
CAST(INV_SKU_ID AS INT64),
GL_ACCT_NR ,
ITM_ADDITIONAL_INFO_TXT,
COMPANY_ID,
SOURCE_SYSTEM,
PRODUCT_TYPE,
PRODUCT_PREFIX,
POLICY_NUM,
STATE_CD,
CAST(PAYMENT_AMT AS FLOAT64),
CAST(OFR_ID AS INT64),
CAST(EMPLOYEE_PRC AS FLOAT64),
CAST(B.GROUP_IND AS INT64),
B.CUST_RECPT_LN_ITM_UOM_CD,
CAST(B.CUST_RECPT_LN_ITM_CHG_ITM AS INT64),
CAST(B.CUST_RECPT_LN_ITM_TAX_ITM AS INT64),
B.CUST_RECPT_VD_RET_IND,
CAST(B.CUST_RECPT_RET_RSN_CD AS INT64),
B.CUST_RECPT_LN_ITM_SER_NR,
CAST(B.UPLOAD_TRANS_NR AS INT64),
CAST(B.DYNAMIC_TYP AS INT64),
B.USER_STRING,
CAST(B.USER_DT AS DATETIME),
CAST(B.USER_DEC AS INT64),
B.PRODUCT_INCPL_IND,
B.PRICE_OVERRIDE_IND,
CAST(B.INV_SER_ID AS INT64),
CAST(B.LAST_UPDATE AS DATETIME),
CAST(B.INV_SKU_POSITION AS INT64),
'jobrunid',
'POS' ,
CURRENT_DATETIME()
)