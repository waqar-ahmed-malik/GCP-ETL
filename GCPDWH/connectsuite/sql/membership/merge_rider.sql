MERGE OPERATIONAL.RIDER AS TGT
USING LANDING.WORK_RIDER AS SRC
ON TGT.RIDE_KY = CAST(TRIM(SRC.RIDE_KY) AS INT64)
WHEN MATCHED
THEN UPDATE SET
TGT.RIDE_COMP_CD = SRC.RIDE_COMP_CD,
TGT.RIDE_EFF_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_EFF_DT),
TGT.RIDE_CANC_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_CANC_DT),
TGT.RIDE_COMM_CD = SRC.RIDE_COMM_CD,
TGT.RIDE_SRC_SLS_CD = SRC.RIDE_SRC_SLS_CD,
TGT.RIDE_SLCT_CD = SRC.RIDE_SLCT_CD,
TGT.RIDE_STS_CD = SRC.RIDE_STS_CD,
TGT.RIDE_STS_DSC_CD = SRC.RIDE_STS_DSC_CD,
TGT.RIDE_PAID_BY_CD = SRC.RIDE_PAID_BY_CD,
TGT.SLS_AGT_KY = CAST(TRIM(SRC.SLS_AGT_KY) AS INT64),
TGT.MBR_KY = CAST(TRIM(SRC.MBR_KY) AS INT64),
TGT.MBRS_KY = CAST(TRIM(SRC.MBRS_KY) AS INT64),
TGT.RIDE_DO_NOT_REN_IN = SRC.RIDE_DO_NOT_REN_IN,
TGT.RIDE_SEC_SAGT_KY = CAST(TRIM(SRC.RIDE_SEC_SAGT_KY) AS INT64),
TGT.RIDE_ACTV_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_ACTV_DT),
TGT.RIDE_PREV_STS_DSC_CD = SRC.RIDE_PREV_STS_DSC_CD,
TGT.RIDE_ADD_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_ADD_DT),
TGT.RIDE_DO_NOT_REN_RSN = SRC.RIDE_DO_NOT_REN_RSN,
TGT.RIDE_PREV_COMM_CD = SRC.RIDE_PREV_COMM_CD,
TGT.RIDE_DNR_EXPIR_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_DNR_EXPIR_DT),
TGT.CARD_REQT_SKIP_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.CARD_REQT_SKIP_DT),
TGT.RIDE_RENEW_CT = CAST(TRIM(SRC.RIDE_RENEW_CT) AS INT64),
TGT.RIDE_OVERAGE_TRAN_IN = SRC.RIDE_OVERAGE_TRAN_IN,
TGT.RIDE_REINST_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_REINST_DT),
TGT.RIDE_EXPIR_DT = PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_EXPIR_DT),
TGT.LAST_UPDATE_DTTIME = CURRENT_DATETIME()
WHEN NOT MATCHED THEN INSERT
(
RIDE_KY,
RIDE_COMP_CD,
RIDE_EFF_DT,
RIDE_CANC_DT,
RIDE_COMM_CD,
RIDE_SRC_SLS_CD,
RIDE_SLCT_CD,
RIDE_STS_CD,
RIDE_STS_DSC_CD,
RIDE_PAID_BY_CD,
SLS_AGT_KY,
MBR_KY,
MBRS_KY,
RIDE_DO_NOT_REN_IN,
RIDE_SEC_SAGT_KY,
RIDE_ACTV_DT,
RIDE_PREV_STS_DSC_CD,
RIDE_ADD_DT,
RIDE_DO_NOT_REN_RSN,
RIDE_PREV_COMM_CD,
RIDE_DNR_EXPIR_DT,
CARD_REQT_SKIP_DT,
RIDE_RENEW_CT,
RIDE_OVERAGE_TRAN_IN,
RIDE_REINST_DT,
RIDE_EXPIR_DT,
LAST_UPDATE_DTTIME,
CREATED_DT,
JOB_RUN_ID,
SOURCE_SYSTEM_CD)
VALUES
(
CAST(TRIM(SRC.RIDE_KY) AS INT64),
SRC.RIDE_COMP_CD,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_EFF_DT),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_CANC_DT),
SRC.RIDE_COMM_CD,
SRC.RIDE_SRC_SLS_CD,
SRC.RIDE_SLCT_CD,
SRC.RIDE_STS_CD,
SRC.RIDE_STS_DSC_CD,
SRC.RIDE_PAID_BY_CD,
CAST(TRIM(SRC.SLS_AGT_KY) AS INT64),
CAST(TRIM(SRC.MBR_KY) AS INT64),
CAST(TRIM(SRC.MBRS_KY) AS INT64),
SRC.RIDE_DO_NOT_REN_IN,
CAST(TRIM(SRC.RIDE_SEC_SAGT_KY) AS INT64),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_ACTV_DT),
SRC.RIDE_PREV_STS_DSC_CD,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_ADD_DT),
SRC.RIDE_DO_NOT_REN_RSN,
SRC.RIDE_PREV_COMM_CD,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_DNR_EXPIR_DT),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.CARD_REQT_SKIP_DT),
CAST(TRIM(SRC.RIDE_RENEW_CT) AS INT64),
SRC.RIDE_OVERAGE_TRAN_IN,
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_REINST_DT),
PARSE_DATETIME('%Y-%m-%d %H:%M:%E*S',SRC.RIDE_EXPIR_DT),
CURRENT_DATETIME(),
CURRENT_DATE(),
'jobrunid',
'CONNECT SUITE'
)