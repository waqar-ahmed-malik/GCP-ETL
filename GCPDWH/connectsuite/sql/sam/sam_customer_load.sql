MERGE CUSTOMERS.SAM_CUSTOMERS A
USING LANDING.WORK_SAM_CUSTOMERS B
ON A.CUSTOMER_ID = SAFE_CAST(B.CUSTOMER_ID AS INT64)
WHEN MATCHED THEN
UPDATE SET
A.MEMBER_ID= B.MEMBER_ID,
A.FIRST_NM= B.FIRST_NM,
A.LAST_NM= B.LAST_NM,
A.MIDDLE_INITIAL= B.MIDDLE_INITIAL,
A.EMAIL_ADDRESS= B.EMAIL_ADDRESS,
A.GENDER= B.GENDER,
A.MARITAL_STATUS= B.MARITAL_STATUS,
A.TRAVEL_AGENT_USER_ID= B.TRAVEL_AGENT_USER_ID,
A.INS_AGENT_USER_ID= B.INS_AGENT_USER_ID,
A.CLUB_CD= B.CLUB_CD,
A.ASSOC_CD= B.ASSOC_CD,
A.MEMBERSHIP_STATUS= B.MEMBERSHIP_STATUS,
A.COMPANY_NM= B.COMPANY_NM,
A.AUTOTRAVEL_AGENT_USER_ID= B.AUTOTRAVEL_AGENT_USER_ID,
A.DONOT_PHONE= B.DONOT_PHONE,
A.DONOT_EMAIL= B.DONOT_EMAIL,
A.DONOT_MAIL= B.DONOT_MAIL ,
A.BIRTH_DT= EXTRACT(DATE FROM PARSE_DATETIME('%F %T',B.BIRTH_DT)),
A.CREATE_DTTIME= PARSE_DATETIME('%F %T',B.CREATE_TM),
A.DUP_OF_CUSTOMER_ID= CAST(B.DUP_OF_CUSTOMER_ID AS INT64),
A.CREATE_BY_USER_ID= B.CREATE_BY_USER_ID,
A.CREATE_METHOD= B.CREATE_METHOD,
A.PRIVATE_BIRTH_DT= B.PRIVATE_BIRTH_DT,
A.PRIVATE_EMAIL_ADDRESS= B.PRIVATE_EMAIL_ADDRESS,
A.EMAIL_TYPE= B.EMAIL_TYPE,
A.PREFERRED_CONTACT= B.PREFERRED_CONTACT,
A.NAME_SUFFIX= B.NAME_SUFFIX,
A.SALUTATION_CD= B.SALUTATION_CD,
A.AUDIT_DTTIME= PARSE_DATETIME('%F %T',B.AUDIT_DT)
WHEN NOT MATCHED THEN
  INSERT (
CUSTOMER_ID,
MEMBER_ID,
FIRST_NM,
LAST_NM,
MIDDLE_INITIAL,
EMAIL_ADDRESS,
GENDER,
MARITAL_STATUS,
TRAVEL_AGENT_USER_ID,
INS_AGENT_USER_ID,
CLUB_CD,
ASSOC_CD,
MEMBERSHIP_STATUS,
COMPANY_NM,
AUTOTRAVEL_AGENT_USER_ID,
DONOT_PHONE,
DONOT_EMAIL,
DONOT_MAIL,
BIRTH_DT,
CREATE_DTTIME,
DUP_OF_CUSTOMER_ID,
CREATE_BY_USER_ID,
CREATE_METHOD,
PRIVATE_BIRTH_DT,
PRIVATE_EMAIL_ADDRESS,
EMAIL_TYPE,
PREFERRED_CONTACT,
NAME_SUFFIX,
SALUTATION_CD,
AUDIT_DTTIME,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATE_DT,
CREATED_BY
) VALUES(
SAFE_CAST(CUSTOMER_ID AS INT64),
MEMBER_ID,
FIRST_NM,
LAST_NM,
MIDDLE_INITIAL,
EMAIL_ADDRESS,
GENDER,
MARITAL_STATUS,
TRAVEL_AGENT_USER_ID,
INS_AGENT_USER_ID,
CLUB_CD,
ASSOC_CD,
MEMBERSHIP_STATUS,
COMPANY_NM,
AUTOTRAVEL_AGENT_USER_ID,
DONOT_PHONE,
DONOT_EMAIL,
DONOT_MAIL,
EXTRACT(DATE FROM PARSE_DATETIME('%F %T',BIRTH_DT)),
PARSE_DATETIME('%F %T',CREATE_TM),
CAST(DUP_OF_CUSTOMER_ID AS INT64),
CREATE_BY_USER_ID,
CREATE_METHOD,
PRIVATE_BIRTH_DT,
PRIVATE_EMAIL_ADDRESS,
EMAIL_TYPE,
PREFERRED_CONTACT,
NAME_SUFFIX,
SALUTATION_CD,
PARSE_DATETIME('%F %T',AUDIT_DT),
'jobrunid',
'SAM' ,
CURRENT_DATETIME(),
'jobname' )