MERGE LANDING.SAM_QUOTES_LDG A
USING LANDING.WORK_SAM_QUOTES B
ON A.QUOTE_ID = CAST(B.QUOTE_ID AS INT64)
WHEN MATCHED THEN
UPDATE SET
A.OPPORTUNITY_ID= CAST(B.OPPORTUNITY_ID AS INT64),
A.CUSTOMER_ID= CAST(B.CUSTOMER_ID AS INT64),
A.SOURCE_CUSTOMER_ID= B.SOURCE_CUSTOMER_ID,
A.SOURCE_QUOTE_ID= B.SOURCE_QUOTE_ID,
A.POLICY_STATUS= B.POLICY_STATUS,
A.PRODUCT_TYPE= B.PRODUCT_TYPE,
A.PRODUCT_CD= B.PRODUCT_CD,
A.POLICY_STATE= B.POLICY_STATE,
A.EFFECTIVE_DT= PARSE_DATETIME('%F %T',B.EFFECTIVE_DT) ,
A.CREATE_DTTIME= PARSE_DATETIME('%F %T', B.CREATE_DTTIME),
A.PREMIUM= CAST(B.PREMIUM AS FLOAT64),
A.POLICY_TERM_MONTHS= CAST(B.POLICY_TERM_MONTHS AS INT64),
A.POLICY_NUM= B.POLICY_NUM,
A.SOURCE_SYSTEM= B.SOURCE_SYSTEM,
A.LAST_MODIFIED_DTTIME= PARSE_DATETIME('%F %T',B.LAST_MODIFIED_DTTIME),
A.POLICY_CARRIER= B.POLICY_CARRIER
WHEN NOT MATCHED THEN
  INSERT (QUOTE_ID,
OPPORTUNITY_ID,
CUSTOMER_ID,
SOURCE_CUSTOMER_ID,
SOURCE_QUOTE_ID,
POLICY_STATUS,
PRODUCT_TYPE,
PRODUCT_CD,
POLICY_STATE,
EFFECTIVE_DT,
CREATE_DTTIME,
PREMIUM,
POLICY_TERM_MONTHS,
POLICY_NUM,
SOURCE_SYSTEM,
LAST_MODIFIED_DTTIME,
POLICY_CARRIER
) VALUES(CAST(QUOTE_ID AS INT64),
CAST(OPPORTUNITY_ID AS INT64),
CAST(CUSTOMER_ID AS INT64),
SOURCE_CUSTOMER_ID,
SOURCE_QUOTE_ID,
POLICY_STATUS,
PRODUCT_TYPE,
PRODUCT_CD,
POLICY_STATE,
PARSE_DATETIME('%F %T',EFFECTIVE_DT) ,
PARSE_DATETIME('%F %T',CREATE_DTTIME) ,
CAST(PREMIUM AS FLOAT64),
CAST(POLICY_TERM_MONTHS AS INT64),
POLICY_NUM,
SOURCE_SYSTEM,
PARSE_DATETIME('%F %T',LAST_MODIFIED_DTTIME) ,
POLICY_CARRIER);