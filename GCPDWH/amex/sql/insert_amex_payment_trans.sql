INSERT INTO OPERATIONAL.AMEX_PAYMENT_TRANSACTION 
(
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PAYMENT_DT,
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
BUSINESS_SUBMISSION_DT,
AMERICAN_EXPRESS_PROCESSING_DT,
SUBMISSION_INVOICE_NUM, 
SUBMISSION_CURRENCY,
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARDMEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
SUBMISSION_GROSS_AMT_IN_PAYMENT_CURRENCY,
TRANSACTION_AMT,
TRANSACTION_DT,
TRANSACTION_TIME ,
TRANSACTION_ID ,
APPROVAL_CD,
TERMINAL_ID,
MERCHANT_CATEGORY_CD,
CARDMEMBER_REFERENCE_NUM,
ACQUIRER_REFERENCE_NUM,
DATA_QUALITY_NON_COMPLIANT_IND,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_1,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_2,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_3,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_4,
NON_SWIPED_IND,
TRANSACTION_REJECTED_IND,
FIRST_INSTALLMENT_AMT,
SUBSEQUENT_INSTALLMENT_AMT,
NUM_OF_INSTALLMENTS,
INSTALLMENT_NUM,
FILLER,
SERVICE_FEE_AMT,
ACCELERATION_AMT,
FILLER_1,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATED_BY,
CREATE_DTTIME
)
SELECT 
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PARSE_DATE('%Y%m%d',PAYMENT_DT) AS PAYMENT_DT,
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
PARSE_DATE('%Y%m%d',BUSINESS_SUBMISSION_DT) AS BUSINESS_SUBMISSION_DT,
PARSE_DATE('%Y%m%d',AMERICAN_EXPRESS_PROCESSING_DT) AS AMERICAN_EXPRESS_PROCESSING_DT,
SUBMISSION_INVOICE_NUM, 
SUBMISSION_CURRENCY,
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARDMEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
CASE WHEN SUBMISSION_GROSS_AMT_IN_PAYMENT_CURRENCY ='' THEN NULL ELSE
CAST( SUBMISSION_GROSS_AMT_IN_PAYMENT_CURRENCY AS FLOAT64) END AS SUBMISSION_GROSS_AMT_IN_PAYMENT_CURRENCY,
CASE WHEN TRANSACTION_AMT ='' THEN NULL ELSE
CAST( TRANSACTION_AMT AS FLOAT64) END AS TRANSACTION_AMT,
PARSE_DATE('%Y%m%d',TRANSACTION_DT) AS TRANSACTION_DT,
TRANSACTION_TIME ,
TRANSACTION_ID ,
APPROVAL_CD,
TERMINAL_ID,
MERCHANT_CATEGORY_CD,
CARDMEMBER_REFERENCE_NUM,
ACQUIRER_REFERENCE_NUM,
DATA_QUALITY_NON_COMPLIANT_IND,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_1,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_2,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_3,
DATA_QUALITY_NON_COMPLIANT_ERROR_CD_4,
NON_SWIPED_IND,
TRANSACTION_REJECTED_IND,
CASE WHEN FIRST_INSTALLMENT_AMT ='' THEN NULL ELSE
CAST( FIRST_INSTALLMENT_AMT AS FLOAT64) END AS FIRST_INSTALLMENT_AMT,
CASE WHEN SUBSEQUENT_INSTALLMENT_AMT ='' THEN NULL ELSE
CAST( SUBSEQUENT_INSTALLMENT_AMT AS FLOAT64) END AS SUBSEQUENT_INSTALLMENT_AMT,
NUM_OF_INSTALLMENTS,
INSTALLMENT_NUM,
FILLER,
CASE WHEN SERVICE_FEE_AMT ='' THEN NULL ELSE
CAST( SERVICE_FEE_AMT AS FLOAT64) END AS SERVICE_FEE_AMT,
CASE WHEN ACCELERATION_AMT ='' THEN NULL ELSE
CAST( ACCELERATION_AMT AS FLOAT64) END AS ACCELERATION_AMT,
FILLER_1,
'v_job_run_id' AS JOB_RUN_ID,
'amex' AS SOURCE_SYSTEM_CD,
'v_job_name' AS CREATED_BY,
CURRENT_DATETIME() AS CREATE_DTTIME
FROM LANDING.WORK_AMEX_TRANSACTION_RECORD
