INSERT INTO OPERATIONAL.AMEX_PAYMENT_CHARGEBACK
(
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PAYMENT_DT,
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
BUSINESS_SUBMISSION_DT,
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARD_MEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
AMERICAN_EXPRESS_PROCESSING_DT,
SUBMISSION_INVOICE_NUM,
SUBMISSION_CURRENCY,
CHARGEBACK_NUM,
CHARGEBACK_REASON_CD,
CHARGEBACK_REASON_DESC,
GROSS_AMT,
DISCOUNT_AMT,
SERVICE_FEE_AMT,
TAX_AMT,
NET_AMT,
DISCOUNT_RT,
SERVICE_FEE_RT,
BATCH_CD,
BILL_CD,
FILLER,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
CREATED_BY,
CREATE_DTTIME
)
SELECT 
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PARSE_DATE('%Y%m%d',PAYMENT_DT) AS PAYMENT_DT,
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
PARSE_DATE('%Y%m%d',BUSINESS_SUBMISSION_DT) AS BUSINESS_SUBMISSION_DT,
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARD_MEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
PARSE_DATE('%Y%m%d',AMERICAN_EXPRESS_PROCESSING_DT) AS AMERICAN_EXPRESS_PROCESSING_DT,
SUBMISSION_INVOICE_NUM,
SUBMISSION_CURRENCY,
CHARGEBACK_NUM,
CHARGEBACK_REASON_CD,
CHARGEBACK_REASON_DESC,
CAST(GROSS_AMT AS FLOAT64) AS GROSS_AMT,
CAST(DISCOUNT_AMT AS FLOAT64) AS DISCOUNT_AMT,
CAST(SERVICE_FEE_AMT AS FLOAT64) AS SERVICE_FEE_AMT,
CAST(TAX_AMT AS FLOAT64) AS TAX_AMT,
CAST(NET_AMT AS FLOAT64) AS NET_AMT,
CAST(DISCOUNT_RATE AS FLOAT64) AS DISCOUNT_RT,
CAST(SERVICE_FEE_RATE AS FLOAT64) AS SERVICE_FEE_RT,
BATCH_CD,
BILL_CD,
FILLER,
'v_job_run_id' AS JOB_RUN_ID,
'amex' AS SOURCE_SYSTEM_CD,
'v_job_name' AS CREATED_BY,
CURRENT_DATETIME() AS CREATE_DTTIME
FROM LANDING.WORK_AMEX_CHARGEBACK_RECORD