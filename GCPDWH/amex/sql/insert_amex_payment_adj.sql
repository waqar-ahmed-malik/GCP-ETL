INSERT INTO OPERATIONAL.AMEX_PAYMENT_ADJUSTMENT
(
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PAYMENT_DT,
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
BUSINESS_SUBMISSION_DT,
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARD_MEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
AMERICAN_EXPRESS_PROCESSING_DT,
SUBMISSION_INVOICE_NUM,
SUBMISSION_CURRENCY,
ADJUSTMENT_NUM,
ADJUSTMENT_REASON_CD,
ADJUSTMENT_REASON_DESC,
GROSS_AMT,
DISCOUNT_AMT,
SERVICE_FEE_AMT,
TAX_AMT,
NET_AMT,
DISCOUNT_RT,
SERVICE_FEE_RT,
BATCH_CD,
BILL_CD,
FILLER,
ETL_JOB_RUN_ID,	
SOURCE_SYSTEM_CD,	
CREATED_BY,
CREATED_DTTIME
)
SELECT 
RECORD_TYPE,
PAYEE_MERCHANT_ID,
SETTLEMENT_ACCOUNT_TYPE_CD,
AMERICAN_EXPRESS_PAYMENT_NUM,
PARSE_DATE('%Y%m%d',PAYMENT_DT),
PAYMENT_CURRENCY,
SUBMISSION_MERCHANT_ID,
PARSE_DATE('%Y%m%d',BUSINESS_SUBMISSION_DT),
MERCHANT_LOCATION_ID,
INVOICE_REFERENCE_NUM,
SELLER_ID,
CARDMEMBER_ACCOUNT_NUM,
INDUSTRY_SPECIFIC_REFERENCE_NUM,
PARSE_DATE('%Y%m%d',AMERICAN_EXPRESS_PROCESSING_DT),
SUBMISSION_INVOICE_NUM,
SUBMISSION_CURRENCY,
ADJUSTMENT_NUM,
ADJUSTMENT_REASON_CD,
ADJUSTMENT_REASON_DESC,
CAST(GROSS_AMT AS FLOAT64),
CAST(DISCOUNT_AMT AS FLOAT64),
CAST(SERVICE_FEE_AMT AS FLOAT64),
CAST(TAX_AMT AS FLOAT64),
CAST(NET_AMT AS FLOAT64),
CAST(DISCOUNT_RATE AS FLOAT64),
CAST(SERVICE_FEE_RATE AS FLOAT64),
BATCH_CD,
BILL_CD,
FILLER,
'v_job_run_id' AS JOB_RUN_ID,
'amex' AS SOURCE_SYSTEM_CD,
'v_job_name' AS CREATED_BY,
CURRENT_DATETIME() AS CREATE_DTTIME
FROM LANDING.WORK_AMEX_ADJUSTMENT_RECORD