INSERT INTO OPERATIONAL.GLOBALWARE_GLTRANSACTIONS
(CTRL,
SEQUENCE_NUM,
SOURCE_NAME,
ACCOUNT_NUM,
POST_DT,
REF1,
REF2,
REF3,
CHECK_NUM,
AP_DUE_DT,
COMMENT,
AMOUNT,
PAY_ID,
STATUS,
CLOSE_DT,
TAG,
BRANCH,
DEPARTMENT,
RECEIPT_NUM,
GROUP_ID,
ADD_AGENT,
ADD_DT,
SUB_SOURCE,
JOB_RUN_ID,
SOURCE_SYSTEM_CD,
LAST_UPDATE_DTTIME
)
SELECT 
SAFE_CAST(CTRL AS INT64),
SAFE_CAST(SEQNUM AS INT64),
SOURCE,
ACCTNUM,
EXTRACT (DATE FROM PARSE_DATETIME("%b %d %Y %I:%M%p",POSTDATE)),
REF1,
REF2,
REF3,
CHECKNUM,
EXTRACT (DATE FROM PARSE_DATETIME("%b %d %Y %I:%M%p",APDUE_DT)),
COMMENT,
SAFE_CAST(AMOUNT AS FLOAT64),
SAFE_CAST(PAY_ID AS INT64),
STATUS,
EXTRACT (DATE FROM PARSE_DATETIME("%b %d %Y %I:%M%p",CLOSE_DT)),
TAG,
BRANCH,
DEPT,
SAFE_CAST(RECEIPT_NUM AS INT64),
GROUP_ID,
ADD_AGENT,
EXTRACT (DATE FROM PARSE_DATETIME("%b %d %Y %I:%M%p",ADD_DT)),
SUBSOURCE,
"jobrunid",
'GLOBALWARE' ,
CURRENT_DATETIME()
FROM LANDING.WORK_GW_GLTRANSACTIONS