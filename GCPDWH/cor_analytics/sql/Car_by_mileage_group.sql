SELECT
    CASE
        WHEN VEHICLE_ODOMETER_READING < 30000 THEN "<30k"
        WHEN VEHICLE_ODOMETER_READING >= 30000 AND VEHICLE_ODOMETER_READING < 60000 THEN "30-60k"
        WHEN VEHICLE_ODOMETER_READING >= 60000 AND VEHICLE_ODOMETER_READING < 90000 THEN "60-90k"
        WHEN VEHICLE_ODOMETER_READING >= 90000 AND VEHICLE_ODOMETER_READING < 120000 THEN "90-120k"
        WHEN VEHICLE_ODOMETER_READING >= 120000 AND VEHICLE_ODOMETER_READING < 150000 THEN "120-150k"
        WHEN VEHICLE_ODOMETER_READING >= 150000 AND VEHICLE_ODOMETER_READING < 180000 THEN "150-180k"
        WHEN VEHICLE_ODOMETER_READING >= 180000 AND VEHICLE_ODOMETER_READING < 210000 THEN "180-210k"
        WHEN VEHICLE_ODOMETER_READING >= 210000 AND VEHICLE_ODOMETER_READING < 250000 THEN "210-250k"
        WHEN VEHICLE_ODOMETER_READING >= 250000 AND VEHICLE_ODOMETER_READING < 300000 THEN "250-300k"
        ELSE '>300k'
        END AS MILEAGE_GROUP,
    COUNT(*) CAR_COUNT
FROM `COR_ANALYTICS.INSURANCE_UNIT_DETAILS_DIM` U
INNER JOIN `COR_ANALYTICS.INSURANCE_CUSTOMER_DIM` C
ON C.AGMT_NUM = U.AGMT_NUM
INNER JOIN `COR_ANALYTICS.WORK_NAPA` COR
ON COR.MEMBERSHIP_NUM = CAST(C.MEMBER_NUM AS INT64)
WHERE
    UPPER(PRODUCT_TYPE) = "AUTO"
    AND VEHICLE_ODOMETER_READING != 0
GROUP BY
    MILEAGE_GROUP
ORDER BY
    CAR_COUNT DESC